"use strict";(self.webpackChunk_3dprgrampattern_website=self.webpackChunk_3dprgrampattern_website||[]).push([[432],{3905:(e,n,t)=>{t.d(n,{Zo:()=>g,kt:()=>c});var l=t(7294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n&&(l=l.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,l)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function r(e,n){if(null==e)return{};var t,l,i=function(e,n){if(null==e)return{};var t,l,i={},a=Object.keys(e);for(l=0;l<a.length;l++)t=a[l],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(l=0;l<a.length;l++)t=a[l],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=l.createContext({}),o=function(e){var n=l.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):p(p({},n),e)),t},g=function(e){var n=o(e.components);return l.createElement(s.Provider,{value:n},e.children)},u="mdxType",k={inlineCode:"code",wrapper:function(e){var n=e.children;return l.createElement(l.Fragment,{},n)}},m=l.forwardRef((function(e,n){var t=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,g=r(e,["components","mdxType","originalType","parentName"]),u=o(t),m=i,c=u["".concat(s,".").concat(m)]||u[m]||k[m]||a;return t?l.createElement(c,p(p({ref:n},g),{},{components:t})):l.createElement(c,p({ref:n},g))}));function c(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=t.length,p=new Array(a);p[0]=m;var r={};for(var s in n)hasOwnProperty.call(n,s)&&(r[s]=n[s]);r.originalType=e,r[u]="string"==typeof e?e:i,p[1]=r;for(var o=2;o<a;o++)p[o]=t[o];return l.createElement.apply(null,p)}return l.createElement.apply(null,t)}m.displayName="MDXCreateElement"},3667:(e,n,t)=>{t.r(n),t.d(n,{contentTitle:()=>p,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>s});var l=t(7462),i=(t(7294),t(3905));const a={sidebar_position:3},p="\u7b2c4\u7ae0 \u7ba1\u9053\u6a21\u5f0f",r={unversionedId:"\u7ba1\u9053\u6a21\u5f0f/\u7ba1\u9053\u6a21\u5f0f",id:"\u7ba1\u9053\u6a21\u5f0f/\u7ba1\u9053\u6a21\u5f0f",title:"\u7b2c4\u7ae0 \u7ba1\u9053\u6a21\u5f0f",description:"\u5728\u4e00\u4e2a\u6a21\u5757\u4e2d\u5b9e\u73b0\u4e24\u4e2a\u8fd0\u884c\u73af\u5883\u7684\u903b\u8f91",source:"@site/docs/\u7ba1\u9053\u6a21\u5f0f/\u7ba1\u9053\u6a21\u5f0f.md",sourceDirName:"\u7ba1\u9053\u6a21\u5f0f",slug:"/\u7ba1\u9053\u6a21\u5f0f/",permalink:"/docs/\u7ba1\u9053\u6a21\u5f0f/",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/\u7ba1\u9053\u6a21\u5f0f/\u7ba1\u9053\u6a21\u5f0f.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"docs",previous:{title:"\u7b2c3\u7ae0 \u79ef\u6728\u6a21\u5f0f",permalink:"/docs/\u79ef\u6728\u6a21\u5f0f/"},next:{title:"\u7b2c5\u7ae0 ECS\u6a21\u5f0f",permalink:"/docs/ECS\u6a21\u5f0f/"}},s=[{value:"\u5728\u4e00\u4e2a\u6a21\u5757\u4e2d\u5b9e\u73b0\u4e24\u4e2a\u8fd0\u884c\u73af\u5883\u7684\u903b\u8f91",id:"\u5728\u4e00\u4e2a\u6a21\u5757\u4e2d\u5b9e\u73b0\u4e24\u4e2a\u8fd0\u884c\u73af\u5883\u7684\u903b\u8f91",children:[{value:"\u9700\u6c42",id:"\u9700\u6c42",children:[],level:3},{value:"\u5b9e\u73b0\u601d\u8def",id:"\u5b9e\u73b0\u601d\u8def",children:[],level:3},{value:"\u7ed9\u51faUML",id:"\u7ed9\u51fauml",children:[],level:3},{value:"\u7ed9\u51fa\u4ee3\u7801",id:"\u7ed9\u51fa\u4ee3\u7801",children:[{value:"Client\u7684\u4ee3\u7801",id:"client\u7684\u4ee3\u7801",children:[],level:4},{value:"Engine\u7684\u4ee3\u7801",id:"engine\u7684\u4ee3\u7801",children:[],level:4},{value:"\u8fd0\u884cClient\u7684\u4ee3\u7801",id:"\u8fd0\u884cclient\u7684\u4ee3\u7801",children:[],level:4}],level:3},{value:"\u63d0\u51fa\u95ee\u9898",id:"\u63d0\u51fa\u95ee\u9898",children:[],level:3}],level:2},{value:"\u62c6\u5206\u6a21\u5757",id:"\u62c6\u5206\u6a21\u5757",children:[{value:"\u6982\u8ff0\u89e3\u51b3\u65b9\u6848",id:"\u6982\u8ff0\u89e3\u51b3\u65b9\u6848",children:[],level:3},{value:"\u7ed9\u51faUML",id:"\u7ed9\u51fauml-1",children:[],level:3},{value:"\u7ed3\u5408UML\u56fe\uff0c\u63cf\u8ff0\u5982\u4f55\u5177\u4f53\u5730\u89e3\u51b3\u95ee\u9898",id:"\u7ed3\u5408uml\u56fe\u63cf\u8ff0\u5982\u4f55\u5177\u4f53\u5730\u89e3\u51b3\u95ee\u9898",children:[],level:3},{value:"\u7ed9\u51fa\u4ee3\u7801",id:"\u7ed9\u51fa\u4ee3\u7801-1",children:[{value:"Client\u7684\u4ee3\u7801",id:"client\u7684\u4ee3\u7801-1",children:[],level:4},{value:"\u521b\u5efaEngineState\u7684\u4ee3\u7801",id:"\u521b\u5efaenginestate\u7684\u4ee3\u7801",children:[],level:4},{value:"Engine\u7684init\u51fd\u6570\u7684\u4ee3\u7801",id:"engine\u7684init\u51fd\u6570\u7684\u4ee3\u7801",children:[],level:4},{value:"Engine\u7684render\u51fd\u6570\u7684\u4ee3\u7801",id:"engine\u7684render\u51fd\u6570\u7684\u4ee3\u7801",children:[],level:4},{value:"EngineInPC\u7684\u4ee3\u7801",id:"engineinpc\u7684\u4ee3\u7801",children:[],level:4},{value:"EngineInPC\u7684\u6b65\u9aa4\u6a21\u5757\u7684\u4ee3\u7801",id:"engineinpc\u7684\u6b65\u9aa4\u6a21\u5757\u7684\u4ee3\u7801",children:[],level:4},{value:"EngineInMobile\u7684\u4ee3\u7801",id:"engineinmobile\u7684\u4ee3\u7801",children:[],level:4},{value:"EngineInMobile\u7684\u6b65\u9aa4\u6a21\u5757\u7684\u4ee3\u7801",id:"engineinmobile\u7684\u6b65\u9aa4\u6a21\u5757\u7684\u4ee3\u7801",children:[],level:4},{value:"\u8fd0\u884cClient\u7684\u4ee3\u7801",id:"\u8fd0\u884cclient\u7684\u4ee3\u7801-1",children:[],level:4}],level:3},{value:"\u63d0\u51fa\u95ee\u9898",id:"\u63d0\u51fa\u95ee\u9898-1",children:[],level:3}],level:2},{value:"\u4f7f\u7528\u7ba1\u9053\u6a21\u5f0f\u6765\u6539\u8fdb",id:"\u4f7f\u7528\u7ba1\u9053\u6a21\u5f0f\u6765\u6539\u8fdb",children:[{value:"\u6982\u8ff0\u89e3\u51b3\u65b9\u6848",id:"\u6982\u8ff0\u89e3\u51b3\u65b9\u6848-1",children:[],level:3},{value:"\u7ed9\u51faUML",id:"\u7ed9\u51fauml-2",children:[],level:3},{value:"\u7ed3\u5408UML\u56fe\uff0c\u63cf\u8ff0\u5982\u4f55\u5177\u4f53\u5730\u89e3\u51b3\u95ee\u9898",id:"\u7ed3\u5408uml\u56fe\u63cf\u8ff0\u5982\u4f55\u5177\u4f53\u5730\u89e3\u51b3\u95ee\u9898-1",children:[],level:3},{value:"\u7ed9\u51fa\u4ee3\u7801",id:"\u7ed9\u51fa\u4ee3\u7801-2",children:[{value:"Client\u7684\u4ee3\u7801",id:"client\u7684\u4ee3\u7801-2",children:[],level:4},{value:"\u521b\u5efaEngineState\u7684\u4ee3\u7801",id:"\u521b\u5efaenginestate\u7684\u4ee3\u7801-1",children:[],level:4},{value:"\u6ce8\u518c\u7ba1\u9053\u6a21\u5757\u7684\u4ee3\u7801",id:"\u6ce8\u518c\u7ba1\u9053\u6a21\u5757\u7684\u4ee3\u7801",children:[],level:4},{value:"Engine\u7684init\u51fd\u6570\u7684\u4ee3\u7801",id:"engine\u7684init\u51fd\u6570\u7684\u4ee3\u7801-1",children:[],level:4},{value:"Engine\u7684render\u51fd\u6570\u7684\u4ee3\u7801",id:"engine\u7684render\u51fd\u6570\u7684\u4ee3\u7801-1",children:[],level:4},{value:"JiaEngineInMobilePipeline\u7684\u76f8\u5173\u4ee3\u7801",id:"jiaengineinmobilepipeline\u7684\u76f8\u5173\u4ee3\u7801",children:[],level:4},{value:"YiEngineInMobilePipeline\u7684\u76f8\u5173\u4ee3\u7801",id:"yiengineinmobilepipeline\u7684\u76f8\u5173\u4ee3\u7801",children:[],level:4},{value:"\u79fb\u52a8\u7aef\u5408\u5e76Render Pipeline\u7684\u76f8\u5173\u4ee3\u7801",id:"\u79fb\u52a8\u7aef\u5408\u5e76render-pipeline\u7684\u76f8\u5173\u4ee3\u7801",children:[],level:4},{value:"EngineInPCPipeline\u7684\u76f8\u5173\u4ee3\u7801",id:"engineinpcpipeline\u7684\u76f8\u5173\u4ee3\u7801",children:[],level:4},{value:"\u8fd0\u884cClient\u7684\u4ee3\u7801",id:"\u8fd0\u884cclient\u7684\u4ee3\u7801-2",children:[],level:4}],level:3}],level:2},{value:"\u5b9a\u4e49",id:"\u5b9a\u4e49",children:[{value:"\u4e00\u53e5\u8bdd\u5b9a\u4e49",id:"\u4e00\u53e5\u8bdd\u5b9a\u4e49",children:[],level:3},{value:"\u8865\u5145\u8bf4\u660e",id:"\u8865\u5145\u8bf4\u660e",children:[],level:3},{value:"\u901a\u7528UML",id:"\u901a\u7528uml",children:[],level:3},{value:"\u89d2\u8272\u7684\u62bd\u8c61\u4ee3\u7801",id:"\u89d2\u8272\u7684\u62bd\u8c61\u4ee3\u7801",children:[{value:"Client\u7684\u62bd\u8c61\u4ee3\u7801",id:"client\u7684\u62bd\u8c61\u4ee3\u7801",children:[],level:4},{value:"System\u7684\u62bd\u8c61\u4ee3\u7801",id:"system\u7684\u62bd\u8c61\u4ee3\u7801",children:[],level:4},{value:"PipelineStateType\u7684\u62bd\u8c61\u4ee3\u7801",id:"pipelinestatetype\u7684\u62bd\u8c61\u4ee3\u7801",children:[],level:4},{value:"Pipeline\u7684\u62bd\u8c61\u4ee3\u7801",id:"pipeline\u7684\u62bd\u8c61\u4ee3\u7801",children:[],level:4},{value:"Job\u7684\u62bd\u8c61\u4ee3\u7801",id:"job\u7684\u62bd\u8c61\u4ee3\u7801",children:[],level:4}],level:3},{value:"\u9075\u5faa\u7684\u8bbe\u8ba1\u539f\u5219\u5728UML\u4e2d\u7684\u4f53\u73b0",id:"\u9075\u5faa\u7684\u8bbe\u8ba1\u539f\u5219\u5728uml\u4e2d\u7684\u4f53\u73b0",children:[],level:3}],level:2},{value:"\u5e94\u7528",id:"\u5e94\u7528",children:[{value:"\u4f18\u70b9",id:"\u4f18\u70b9",children:[],level:3},{value:"\u7f3a\u70b9",id:"\u7f3a\u70b9",children:[],level:3},{value:"\u4f7f\u7528\u573a\u666f",id:"\u4f7f\u7528\u573a\u666f",children:[{value:"\u573a\u666f\u63cf\u8ff0",id:"\u573a\u666f\u63cf\u8ff0",children:[],level:4},{value:"\u5177\u4f53\u6848\u4f8b",id:"\u5177\u4f53\u6848\u4f8b",children:[],level:4}],level:3},{value:"\u6ce8\u610f\u4e8b\u9879",id:"\u6ce8\u610f\u4e8b\u9879",children:[],level:3}],level:2},{value:"\u6269\u5c55",id:"\u6269\u5c55",children:[{value:"\u907f\u514d\u4f7f\u7528\u5168\u5c40\u53d8\u91cf\u6765\u4fdd\u5b58\u914d\u7f6e\u6570\u636e\uff0c\u6539\u4e3a\u5728\u6ce8\u518c\u7ba1\u9053\u65f6\u4f20\u5165\u7ba1\u9053\u7684\u914d\u7f6e\u6570\u636e",id:"\u907f\u514d\u4f7f\u7528\u5168\u5c40\u53d8\u91cf\u6765\u4fdd\u5b58\u914d\u7f6e\u6570\u636e\u6539\u4e3a\u5728\u6ce8\u518c\u7ba1\u9053\u65f6\u4f20\u5165\u7ba1\u9053\u7684\u914d\u7f6e\u6570\u636e",children:[],level:3},{value:"\u53ef\u4ee5\u589e\u5f3a\u7ba1\u9053\u6a21\u5757\u7684JSON\u914d\u7f6e\u6570\u636e",id:"\u53ef\u4ee5\u589e\u5f3a\u7ba1\u9053\u6a21\u5757\u7684json\u914d\u7f6e\u6570\u636e",children:[],level:3}],level:2},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",children:[{value:"\u54ea\u4e9b\u573a\u666f\u4e0d\u9700\u8981\u4f7f\u7528\u6a21\u5f0f",id:"\u54ea\u4e9b\u573a\u666f\u4e0d\u9700\u8981\u4f7f\u7528\u6a21\u5f0f",children:[],level:3},{value:"\u7ed9\u51fa\u5177\u4f53\u7684\u5b9e\u8df5\u6848\u4f8b",id:"\u7ed9\u51fa\u5177\u4f53\u7684\u5b9e\u8df5\u6848\u4f8b",children:[{value:"\u652f\u6301\u5404\u79cd\u8fd0\u884c\u73af\u5883",id:"\u652f\u6301\u5404\u79cd\u8fd0\u884c\u73af\u5883",children:[],level:4},{value:"\u81ea\u5b9a\u4e49\u7ba1\u9053",id:"\u81ea\u5b9a\u4e49\u7ba1\u9053",children:[],level:4}],level:3}],level:2},{value:"\u66f4\u591a\u8d44\u6599\u63a8\u8350",id:"\u66f4\u591a\u8d44\u6599\u63a8\u8350",children:[],level:2}],o={toc:s},g="wrapper";function u(e){let{components:n,...a}=e;return(0,i.kt)(g,(0,l.Z)({},o,a,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"\u7b2c4\u7ae0-\u7ba1\u9053\u6a21\u5f0f"},"\u7b2c4\u7ae0 \u7ba1\u9053\u6a21\u5f0f"),(0,i.kt)("h2",{id:"\u5728\u4e00\u4e2a\u6a21\u5757\u4e2d\u5b9e\u73b0\u4e24\u4e2a\u8fd0\u884c\u73af\u5883\u7684\u903b\u8f91"},"\u5728\u4e00\u4e2a\u6a21\u5757\u4e2d\u5b9e\u73b0\u4e24\u4e2a\u8fd0\u884c\u73af\u5883\u7684\u903b\u8f91"),(0,i.kt)("h3",{id:"\u9700\u6c42"},"\u9700\u6c42"),(0,i.kt)("p",null,"\u5f00\u53d1\u8005\u7532\u8981\u5b9e\u73b0\u5f15\u64ce\u7684\u6e32\u67d3\uff0c\u5e76\u4f7f\u5176\u80fd\u591f\u540c\u65f6\u8fd0\u884c\u5728PC\u7aef\u548c\u79fb\u52a8\u7aef\u3002\u4e24\u4e2a\u8fd0\u884c\u73af\u5883\u7684\u5dee\u5f02\u5982\u4e0b\u6240\u793a\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"PC\u7aef\u652f\u6301WebGL2\uff0c\u79fb\u52a8\u7aef\u53ea\u652f\u6301WebGL1"),(0,i.kt)("li",{parentName:"ul"},"PC\u7aef\u53ef\u4ee5\u4f7f\u7528\u5ef6\u8fdf\u6e32\u67d3\u7684\u7b97\u6cd5\u6765\u6e32\u67d3\uff0c\u79fb\u52a8\u7aef\u56e0\u4e3a\u4e0d\u652f\u6301multi render targets\uff0c\u6240\u4ee5\u53ea\u80fd\u4f7f\u7528\u524d\u5411\u6e32\u67d3\u7684\u7b97\u6cd5\u6765\u6e32\u67d3")),(0,i.kt)("h3",{id:"\u5b9e\u73b0\u601d\u8def"},"\u5b9e\u73b0\u601d\u8def"),(0,i.kt)("p",null,"\u5f15\u64ce\u9700\u8981\u5b9e\u73b0\u521d\u59cb\u5316\u3001\u6e32\u67d3\u8fd9\u4e24\u4e2a\u903b\u8f91\uff0c\u5176\u4e2d\u521d\u59cb\u5316\u53ef\u5206\u89e3\u4e3a\u521d\u59cb\u5316WebGL\u8fd9\u4e00\u4e2a\u6b65\u9aa4\uff0c\u6e32\u67d3\u53ef\u5206\u89e3\u4e3a\u6e32\u67d3\u3001Tonemap\u540e\u5904\u7406\u8fd9\u4e24\u4e2a\u6b65\u9aa4"),(0,i.kt)("p",null,"\u5904\u7406\u8fd0\u884c\u73af\u5883\u7684\u5dee\u5f02\u7684\u601d\u8def\u662f\u5728\u6bcf\u4e2a\u6b65\u9aa4\u4e2d\u5224\u65ad\u8fd0\u884c\u73af\u5883\uff0c\u8fdb\u884c\u5bf9\u5e94\u7684\u5904\u7406\uff0c\u5177\u4f53\u5982\u4e0b\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5728\u201c\u521d\u59cb\u5316WebGL\u201d\u4e2d\u5224\u65ad\u8fd0\u884c\u73af\u5883\uff0c\u5982\u679c\u662fPC\u7aef\u5c31\u83b7\u5f97WebGL2\u7684\u4e0a\u4e0b\u6587\uff0c\u5426\u5219\u5c31\u83b7\u5f97WebGL1\u7684\u4e0a\u4e0b\u6587"),(0,i.kt)("li",{parentName:"ul"},"\u5728\u201c\u6e32\u67d3\u201d\u4e2d\u5224\u65ad\u8fd0\u884c\u73af\u5883\uff0c\u5982\u679c\u662fPC\u7aef\u5c31\u4f7f\u7528\u5ef6\u8fdf\u6e32\u67d3\u7b97\u6cd5\uff0c\u5426\u5219\u5c31\u4f7f\u7528\u524d\u5411\u6e32\u67d3\u7b97\u6cd5"),(0,i.kt)("li",{parentName:"ul"},"\u5728\u201cTonemap\u201d\u4e2d\u5224\u65ad\u8fd0\u884c\u73af\u5883\uff0c\u5982\u679c\u662fPC\u7aef\u5c31\u4f7f\u7528WebGL2\u7684\u4e0a\u4e0b\u6587\uff0c\u5426\u5219\u5c31\u4f7f\u7528WebGL1\u7684\u4e0a\u4e0b\u6587")),(0,i.kt)("h3",{id:"\u7ed9\u51fauml"},"\u7ed9\u51faUML"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u9886\u57df\u6a21\u578b")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"\u9886\u57df\u6a21\u578b\u56fe",src:t(9696).Z})),(0,i.kt)("p",null,"\u603b\u4f53\u6765\u770b\uff0c\u9886\u57df\u6a21\u578b\u5206\u4e3a\u7528\u6237\u3001Engine\u8fd9\u4e24\u4e2a\u90e8\u5206"),(0,i.kt)("p",null,"\u6211\u4eec\u6765\u770b\u4e0b\u7528\u6237\u8fd9\u4e2a\u90e8\u5206\uff1a"),(0,i.kt)("p",null,"Client\u662f\u7528\u6237"),(0,i.kt)("p",null,"\u6211\u4eec\u6765\u770b\u4e0bEngine\u8fd9\u4e2a\u90e8\u5206\uff1a"),(0,i.kt)("p",null,"Engine\u662f\u5f15\u64ce\uff0c\u8d1f\u8d23\u521d\u59cb\u5316\u548c\u6e32\u67d3\u3002Engine\u6709\u4e00\u4e2aEngineState\u6570\u636e\uff0c\u7528\u6765\u4fdd\u5b58\u5f15\u64ce\u7684\u6240\u6709\u6570\u636e\u3002Engine\u7684createState\u51fd\u6570\u5b9e\u73b0\u521b\u5efaEngineState\uff0cEngine\u7684init\u51fd\u6570\u5b9e\u73b0\u521d\u59cb\u5316\uff0cEngine\u7684render\u51fd\u6570\u5b9e\u73b0\u6e32\u67d3"),(0,i.kt)("h3",{id:"\u7ed9\u51fa\u4ee3\u7801"},"\u7ed9\u51fa\u4ee3\u7801"),(0,i.kt)("p",null,"\u9996\u5148\uff0c\u6211\u4eec\u4f9d\u6b21\u770b\u4e0b\u6bcf\u4e2a\u6a21\u5757\u7684\u4ee3\u7801\uff0c\u5b83\u4eec\u5305\u62ec\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Client\u7684\u4ee3\u7801\uff1b"),(0,i.kt)("li",{parentName:"ul"},"Engine\u7684\u4ee3\u7801\uff1b")),(0,i.kt)("p",null,"\u6700\u540e\uff0c\u6211\u4eec\u8fd0\u884cClient\u7684\u4ee3\u7801"),(0,i.kt)("h4",{id:"client\u7684\u4ee3\u7801"},"Client\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"Client"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"//\u6784\u9020\u5047canvas\nlet canvas = {\n    getContext: (_) => 1 as any\n}\n\n//\u6b64\u5904\u8bbe\u7f6e\u8fd0\u884c\u73af\u5883\u4e3aPC\u7aef\n//\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u4e3afalse\u6765\u8bbe\u7f6e\u8fd0\u884c\u73af\u5883\u4e3a\u79fb\u52a8\u7aef \nglobalThis.isPC = true\n\nlet state = Engine.createState()\n\nstate = Engine.init(state, canvas)\nstate = Engine.render(state)\n")),(0,i.kt)("p",null,"Client\u9996\u5148\u8c03\u7528createState\u51fd\u6570\u521b\u5efa\u4e86\u5f15\u64ce\u7684EngineState\uff1b\u7136\u540e\u8c03\u7528init\u51fd\u6570\u8fdb\u884c\u521d\u59cb\u5316\uff1b\u6700\u540e\u8c03\u7528render\u51fd\u6570\u8fdb\u884c\u6e32\u67d3"),(0,i.kt)("h4",{id:"engine\u7684\u4ee3\u7801"},"Engine\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"EngineStateType"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export type state = {\n    gl: WebGLRenderingContext | WebGL2RenderingContext | null\n}\n")),(0,i.kt)("p",null,"EngineStateType\u5b9a\u4e49\u4e86EngineState\u7684\u7c7b\u578b\uff0c\u5176\u4e2dgl\u5b57\u6bb5\u4fdd\u5b58\u4e86WebGL\u4e0a\u4e0b\u6587\u3002\u56e0\u4e3a\u5b83\u53ef\u80fd\u662fWebGL1\u6216\u8005WebGL2\u7684\u4e0a\u4e0b\u6587\uff0c\u6240\u4ee5gl\u7684\u7c7b\u578b\u4e5f\u662f\u8fd9\u4e24\u4e2a\u7c7b\u578b\u7684\u8054\u5408\u7c7b\u578b"),(0,i.kt)("p",null,"Engine"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'let _isPC = () => {\n    return globalThis.isPC\n}\n\nlet _initWebGL = (state, canvas) => {\n    let gl = null\n\n    if (_isPC()) {\n        gl = canvas.getContext("webgl2")\n    }\n    else {\n        gl = canvas.getContext("webgl1")\n    }\n\n    return {\n        ...state,\n        gl: gl\n    }\n}\n\nlet _render = (state) => {\n    if (_isPC()) {\n        let gl = getExnFromStrictNull(state.gl) as WebGL2RenderingContext\n\n        console.log("\u5ef6\u8fdf\u6e32\u67d3")\n    }\n    else {\n        let gl = getExnFromStrictNull(state.gl) as WebGLRenderingContext\n\n        console.log("\u524d\u5411\u6e32\u67d3")\n    }\n\n    return state\n}\n\nlet _tonemap = (state) => {\n    let gl = null\n\n    if (_isPC()) {\n        gl = getExnFromStrictNull(state.gl) as WebGL2RenderingContext\n    }\n    else {\n        gl = getExnFromStrictNull(state.gl) as WebGLRenderingContext\n    }\n\n    console.log("tonemap")\n\n    return state\n}\n\nexport let createState = (): state => {\n    return {\n        gl: null\n    }\n}\n\nexport let init = (state: state, canvas) => {\n    console.log(globalThis.isPC ? "is PC" : "is mobile")\n\n    state = _initWebGL(state, canvas)\n\n    return state\n}\n\nexport let render = (state: state) => {\n    state = _render(state)\n    state = _tonemap(state)\n\n    return state\n}\n')),(0,i.kt)("p",null,"\u521d\u59cb\u5316\u7684\u201c\u521d\u59cb\u5316WebGL\u201d\u6b65\u9aa4\u5728_initWebGL\u8fd9\u4e2a\u51fd\u6570\u4e2d\u5b9e\u73b0\uff0c\u6e32\u67d3\u7684\u201c\u6e32\u67d3\u201d\u3001\u201cTonemap\u540e\u5904\u7406\u201d\u8fd9\u4e24\u4e2a\u6b65\u9aa4\u5206\u522b\u5728_render\u3001_tonemap\u8fd9\u4e24\u4e2a\u51fd\u6570\u4e2d\u5b9e\u73b0\u3002\u6bcf\u4e2a\u6b65\u9aa4\u90fd\u5224\u65ad\u4e86\u8fd0\u884c\u73af\u5883\uff0c\u6267\u884c\u5bf9\u5e94\u7684\u903b\u8f91"),(0,i.kt)("h4",{id:"\u8fd0\u884cclient\u7684\u4ee3\u7801"},"\u8fd0\u884cClient\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"\u4e0b\u9762\uff0c\u6211\u4eec\u8fd0\u884cClient\u7684\u4ee3\u7801\uff0c\u6253\u5370\u7684\u7ed3\u679c\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"is PC\n\u521d\u59cb\u5316WebGL2\n\u5ef6\u8fdf\u6e32\u67d3\ntonemap for WebGL2\n")),(0,i.kt)("p",null,"\u56e0\u4e3a\u8fd9\u91cc\u6307\u5b9a\u73af\u5883\u4e3aPC\u7aef\uff0c\u6240\u4ee5\u6267\u884c\u7684\u662fPC\u7aef\u7684\u903b\u8f91"),(0,i.kt)("h3",{id:"\u63d0\u51fa\u95ee\u9898"},"\u63d0\u51fa\u95ee\u9898"),(0,i.kt)("p",null,"\u4e3a\u4e86\u52a0\u5feb\u5f00\u53d1\u8fdb\u5ea6\uff0c\u7532\u627e\u5230\u4e86\u5f00\u53d1\u8005\u4e59\u6765\u4e00\u8d77\u5f00\u53d1\uff0c\u5176\u4e2d\u7532\u8d1f\u8d23PC\u7aef\u7684\u6240\u6709\u6b65\u9aa4\u548c\u79fb\u52a8\u7aef\u7684\u201c\u521d\u59cb\u5316WebGL\u201d\u3001\u201c\u524d\u5411\u6e32\u67d3\u201d\u8fd9\u4e24\u4e2a\u6b65\u9aa4\uff0c\u4e59\u8d1f\u8d23\u79fb\u52a8\u7aef\u7684\u201cTonemap\u540e\u5904\u7406\u201d\u8fd9\u4e2a\u6b65\u9aa4\u3002"),(0,i.kt)("p",null,"\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\uff0c\u9047\u5230\u4e86\u4e0b\u9762\u7684\u95ee\u9898\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5f00\u53d1\u6548\u7387\u4f4e",(0,i.kt)("br",{parentName:"li"}),"\u7531\u4e8e\u4e24\u4e2a\u8fd0\u884c\u73af\u5883\u7684\u903b\u8f91\u6df7\u6742\u5728\u540c\u4e00\u4e2a\u6a21\u5757\u7684\u540c\u4e00\u4e2a\u51fd\u6570\u4e2d\uff0c\u5bfc\u81f4\u4e24\u4e2a\u5f00\u53d1\u8005\u5728\u5f00\u53d1\u65f6\u76f8\u4e92\u5f71\u54cd\uff0c\u5bfc\u81f4\u5bb9\u6613\u51fa\u73b0\u4ee3\u7801\u51b2\u7a81\uff0c\u6700\u7ec8\u4f7f\u5f97\u6574\u4f53\u7684\u5f00\u53d1\u6548\u7387\u9010\u6e10\u53d8\u6162")),(0,i.kt)("h2",{id:"\u62c6\u5206\u6a21\u5757"},"\u62c6\u5206\u6a21\u5757"),(0,i.kt)("h3",{id:"\u6982\u8ff0\u89e3\u51b3\u65b9\u6848"},"\u6982\u8ff0\u89e3\u51b3\u65b9\u6848"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5206\u79bbPC\u7aef\u548c\u79fb\u52a8\u7aef\u7684\u903b\u8f91\u4e3a\u4e0d\u540c\u7684\u6a21\u5757",(0,i.kt)("br",{parentName:"p"}),"\n","\u4eceEngine\u4e2d\u63d0\u51fa\u4e24\u4e2a\u6a21\u5757\uff1aEngineInPC\u3001EngineInMobile\uff0c\u5206\u522b\u5b9e\u73b0PC\u7aef\u548c\u79fb\u52a8\u7aef\u7684\u903b\u8f91\uff1b\u7136\u540e\u5728Engine\u4e2d\u5224\u65ad\u8fd0\u884c\u73af\u5883\uff0c\u8c03\u7528\u5bf9\u5e94\u7684\u6a21\u5757")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5c06\u6bcf\u4e2a\u6b65\u9aa4\u63d0\u51fa\u6210\u5355\u72ec\u7684\u6a21\u5757\uff0c\u8fd9\u6837\u53ef\u51cf\u5c11\u6b65\u9aa4\u4e4b\u95f4\u7684\u8026\u5408\uff0c\u4fbf\u4e8e\u7ef4\u62a4"))),(0,i.kt)("h3",{id:"\u7ed9\u51fauml-1"},"\u7ed9\u51faUML"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u9886\u57df\u6a21\u578b")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"\u9886\u57df\u6a21\u578b\u56fe",src:t(7140).Z})),(0,i.kt)("p",null,"\u603b\u4f53\u6765\u770b\uff0c\u9886\u57df\u6a21\u578b\u5206\u4e3a\u7528\u6237\u3001Engine\u3001\u9488\u5bf9\u6bcf\u4e2a\u8fd0\u884c\u73af\u5883\u7684\u5f15\u64ce\u5b9e\u73b0\u3001\u6b65\u9aa4\u8fd9\u56db\u4e2a\u90e8\u5206"),(0,i.kt)("p",null,"\u6211\u4eec\u770b\u4e0b\u7528\u6237\u3001Engine\u8fd9\u4e24\u4e2a\u90e8\u5206\uff1a"),(0,i.kt)("p",null,"Client\u662f\u7528\u6237"),(0,i.kt)("p",null,"Engine\u662f\u5f15\u64ce\u95e8\u6237\uff0c\u8d1f\u8d23\u5224\u65ad\u8fd0\u884c\u73af\u5883\uff0c\u8c03\u7528\u5bf9\u5e94\u7684\u6a21\u5757"),(0,i.kt)("p",null,"\u6211\u4eec\u770b\u4e0b\u9488\u5bf9\u6bcf\u4e2a\u8fd0\u884c\u73af\u5883\u7684\u5f15\u64ce\u5b9e\u73b0\u8fd9\u4e2a\u90e8\u5206\uff1a"),(0,i.kt)("p",null,"EngineInPC\u8d1f\u8d23PC\u7aef\u7684\u5f15\u64ce\u5b9e\u73b0"),(0,i.kt)("p",null,"EngineInMobile\u8d1f\u8d23\u79fb\u52a8\u7aef\u7684\u5f15\u64ce\u5b9e\u73b0"),(0,i.kt)("p",null,"\u6211\u4eec\u770b\u4e0b\u6b65\u9aa4\u8fd9\u4e2a\u90e8\u5206\uff1a"),(0,i.kt)("p",null,"EngineInPC\u7684\u6b65\u9aa4\u6a21\u5757\u5982\u4e0b\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"InitWebGL2\u8d1f\u8d23\u521d\u59cb\u5316WebGL2"),(0,i.kt)("li",{parentName:"ul"},"DeferRender\u8d1f\u8d23\u5ef6\u8fdf\u6e32\u67d3"),(0,i.kt)("li",{parentName:"ul"},"TonemapForWebGL2\u8d1f\u8d23\u4f7f\u7528WebGL2\u5b9e\u73b0Tonemap\u540e\u5904\u7406")),(0,i.kt)("p",null,"EngineInMobile\u7684\u6b65\u9aa4\u6a21\u5757\u5982\u4e0b\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"InitWebGL1\u8d1f\u8d23\u521d\u59cb\u5316WebGL1"),(0,i.kt)("li",{parentName:"ul"},"ForwardRender\u8d1f\u8d23\u524d\u5411\u6e32\u67d3"),(0,i.kt)("li",{parentName:"ul"},"TonemapForWebGL1\u8d1f\u8d23\u4f7f\u7528WebGL1\u5b9e\u73b0Tonemap\u540e\u5904\u7406")),(0,i.kt)("h3",{id:"\u7ed3\u5408uml\u56fe\u63cf\u8ff0\u5982\u4f55\u5177\u4f53\u5730\u89e3\u51b3\u95ee\u9898"},"\u7ed3\u5408UML\u56fe\uff0c\u63cf\u8ff0\u5982\u4f55\u5177\u4f53\u5730\u89e3\u51b3\u95ee\u9898"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u73b0\u5728\u7532\u8d1f\u8d23EngineInPC\u7684\u6240\u6709\u6b65\u9aa4\u6a21\u5757\u548cEngineInMobile\u7684InitWebGL1\u3001ForwardRender\u6b65\u9aa4\u6a21\u5757\uff0c\u4e59\u8d1f\u8d23EngineInMobile\u7684TonemapForWebGL1\u6b65\u9aa4\u6a21\u5757\uff0c\u4e24\u4eba\u76f8\u4e92\u4e0d\u5f71\u54cd")),(0,i.kt)("h3",{id:"\u7ed9\u51fa\u4ee3\u7801-1"},"\u7ed9\u51fa\u4ee3\u7801"),(0,i.kt)("p",null,"\u9996\u5148\uff0c\u6211\u4eec\u770b\u4e0bClient\u7684\u4ee3\u7801\uff1b"),(0,i.kt)("p",null,"\u7136\u540e\uff0c\u6211\u4eec\u4f9d\u6b21\u770b\u4e0bClient\u4ee3\u7801\u4e2d\u6bcf\u4e2a\u6b65\u9aa4\u7684\u4ee3\u7801\uff0c\u5b83\u4eec\u5305\u62ec\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u521b\u5efaEngineState\u7684\u4ee3\u7801"),(0,i.kt)("li",{parentName:"ul"},"Engine\u7684init\u51fd\u6570\u7684\u4ee3\u7801"),(0,i.kt)("li",{parentName:"ul"},"Engine\u7684render\u51fd\u6570\u7684\u4ee3\u7801")),(0,i.kt)("p",null,"\u7136\u540e\uff0c\u56e0\u4e3aEngine\u8c03\u7528\u4e86EngineInPC\u6765\u5b9e\u73b0PC\u7aef\u7684\u903b\u8f91\uff0c\u6240\u4ee5\u6211\u4eec\u770b\u4e0b\u76f8\u5173\u7684\u4ee3\u7801\uff0c\u5b83\u4eec\u5305\u62ec\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"EngineInPC\u7684\u4ee3\u7801\uff1b"),(0,i.kt)("li",{parentName:"ul"},"EngineInPC\u7684\u6b65\u9aa4\u6a21\u5757\u7684\u4ee3\u7801\uff1b")),(0,i.kt)("p",null,"\u7136\u540e\uff0c\u56e0\u4e3aEngine\u8c03\u7528\u4e86EngineInMobile\u6765\u5b9e\u73b0\u79fb\u52a8\u7aef\u7684\u903b\u8f91\uff0c\u6240\u4ee5\u6211\u4eec\u770b\u4e0b\u76f8\u5173\u7684\u4ee3\u7801\uff0c\u5b83\u4eec\u5305\u62ec\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"EngineInMobile\u7684\u4ee3\u7801\uff1b"),(0,i.kt)("li",{parentName:"ul"},"EngineInMobile\u7684\u6b65\u9aa4\u6a21\u5757\u7684\u4ee3\u7801\uff1b")),(0,i.kt)("p",null,"\u6700\u540e\uff0c\u6211\u4eec\u8fd0\u884cClient\u7684\u4ee3\u7801"),(0,i.kt)("h4",{id:"client\u7684\u4ee3\u7801-1"},"Client\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"Client\u4ee3\u7801\u8ddf\u4e4b\u524d\u4e00\u6837\uff0c\u6545\u7701\u7565"),(0,i.kt)("h4",{id:"\u521b\u5efaenginestate\u7684\u4ee3\u7801"},"\u521b\u5efaEngineState\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"EngineStateType"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export type engineInPCState = {\n    gl: WebGL2RenderingContext | null\n}\n\nexport type engineInMobileState = {\n    gl: WebGL2RenderingContext | null\n}\n\nexport type state = {\n    engineInPC: engineInPCState,\n    engineInMobile: engineInMobileState,\n}\n")),(0,i.kt)("p",null,"Engine"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export let createState = (): state => {\n    return {\n        engineInPC: {\n            gl: null\n        },\n        engineInMobile: {\n            gl: null\n        }\n    }\n}\n")),(0,i.kt)("p",null,"createState\u51fd\u6570\u521b\u5efa\u4e86EngineState\uff0c\u5b83\u73b0\u5728\u4f7f\u7528\u4e24\u4e2a\u5b57\u6bb5\u6765\u5206\u522b\u4fdd\u5b58\u4e24\u4e2a\u8fd0\u884c\u73af\u5883\u7684\u6570\u636e\uff0c\u4e92\u4e0d\u5e72\u6270"),(0,i.kt)("h4",{id:"engine\u7684init\u51fd\u6570\u7684\u4ee3\u7801"},"Engine\u7684init\u51fd\u6570\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"Engine"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'let _isPC = () => {\n    return globalThis.isPC\n}\n\nexport let init = (state: state, canvas) => {\n    console.log(globalThis.isPC ? "is PC" : "is mobile")\n\n    if (_isPC()) {\n        state = EngineInPC.init(state, canvas)\n    }\n    else {\n        state = EngineInMobile.init(state, canvas)\n    }\n\n    return state\n}\n')),(0,i.kt)("p",null,"init\u51fd\u6570\u5b9e\u73b0\u4e86\u521d\u59cb\u5316\u7684\u903b\u8f91\uff0c\u5b83\u6839\u636e\u4e0d\u540c\u7684\u8fd0\u884c\u73af\u5883\u6765\u8c03\u7528\u5bf9\u5e94\u7684\u6a21\u5757"),(0,i.kt)("h4",{id:"engine\u7684render\u51fd\u6570\u7684\u4ee3\u7801"},"Engine\u7684render\u51fd\u6570\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"Engine"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export let render = (state: state) => {\n    if (_isPC()) {\n        state = EngineInPC.render(state)\n    }\n    else {\n        state = EngineInMobile.render(state)\n    }\n\n    return state\n}\n")),(0,i.kt)("p",null,"render\u51fd\u6570\u5b9e\u73b0\u4e86\u6e32\u67d3\u7684\u903b\u8f91\uff0c\u5b83\u6839\u636e\u4e0d\u540c\u7684\u8fd0\u884c\u73af\u5883\u6765\u8c03\u7528\u5bf9\u5e94\u7684\u6a21\u5757"),(0,i.kt)("h4",{id:"engineinpc\u7684\u4ee3\u7801"},"EngineInPC\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"EngineInPC"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export let init = (state: state, canvas) => {\n    state = InitWebGL2.initWebGL2(state, canvas)\n\n    return state\n}\n\nexport let render = (state: state) => {\n    state = DeferRender.deferRender(state)\n    state = TonemapForWebGL2.tonemap(state)\n\n    return state\n}\n")),(0,i.kt)("p",null,"\u5b83\u8c03\u7528\u6b65\u9aa4\u6a21\u5757\u6765\u6267\u884cPC\u7aef\u8fd0\u884c\u73af\u5883\u7684\u521d\u59cb\u5316\u548c\u6e32\u67d3"),(0,i.kt)("h4",{id:"engineinpc\u7684\u6b65\u9aa4\u6a21\u5757\u7684\u4ee3\u7801"},"EngineInPC\u7684\u6b65\u9aa4\u6a21\u5757\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"InitWebGL2"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export let initWebGL2 = (state: state, canvas) => {\n    console.log("\u521d\u59cb\u5316WebGL2")\n\n    return {\n        ...state,\n        engineInPC: {\n            gl: canvas.getContext("webgl2")\n        }\n    }\n}\n')),(0,i.kt)("p",null,"DeferRender"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export let deferRender = (state: state) => {\n    let gl = getExnFromStrictNull(state.engineInPC.gl)\n\n    console.log("\u5ef6\u8fdf\u6e32\u67d3")\n\n    return state\n}\n')),(0,i.kt)("p",null,"TonemapForWebGL2"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export let tonemap = (state: state) => {\n    let gl = getExnFromStrictNull(state.engineInPC.gl)\n\n    console.log("tonemap for WebGL2")\n\n    return state\n}\n')),(0,i.kt)("p",null,"\u5404\u4e2a\u6b65\u9aa4\u6a21\u5757\u7684\u903b\u8f91\u8ddf\u4e4b\u524d\u4e00\u6837"),(0,i.kt)("h4",{id:"engineinmobile\u7684\u4ee3\u7801"},"EngineInMobile\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"EngineInMobile"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export let init = (state: state, canvas) => {\n    state = InitWebGL1.initWebGL1(state, canvas)\n\n    return state\n}\n\nexport let render = (state: state) => {\n    state = ForwardRender.forwardRender(state)\n    state = TonemapForWebGL1.tonemap(state)\n\n    return state\n}\n")),(0,i.kt)("p",null,"\u5b83\u8c03\u7528\u6b65\u9aa4\u6a21\u5757\u6765\u6267\u884c\u79fb\u52a8\u7aef\u8fd0\u884c\u73af\u5883\u7684\u521d\u59cb\u5316\u548c\u6e32\u67d3"),(0,i.kt)("h4",{id:"engineinmobile\u7684\u6b65\u9aa4\u6a21\u5757\u7684\u4ee3\u7801"},"EngineInMobile\u7684\u6b65\u9aa4\u6a21\u5757\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"InitWebGL1"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export let initWebGL1 = (state: state, canvas) => {\n    console.log("\u521d\u59cb\u5316WebGL1")\n\n    return {\n        ...state,\n        engineInMobile: {\n            gl: canvas.getContext("webgl1")\n        }\n    }\n}\n')),(0,i.kt)("p",null,"ForwardRender"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export let forwardRender = (state: state) => {\n    let gl = getExnFromStrictNull(state.engineInMobile.gl)\n\n    console.log("\u524d\u5411\u6e32\u67d3")\n\n    return state\n}\n')),(0,i.kt)("p",null,"TonemapForWebGL1"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export let tonemap = (state: state) => {\n    let gl = getExnFromStrictNull(state.engineInMobile.gl)\n\n    console.log("tonemap for WebGL1")\n\n    return state\n}\n')),(0,i.kt)("p",null,"\u5404\u4e2a\u6b65\u9aa4\u6a21\u5757\u7684\u903b\u8f91\u8ddf\u4e4b\u524d\u4e00\u6837"),(0,i.kt)("h4",{id:"\u8fd0\u884cclient\u7684\u4ee3\u7801-1"},"\u8fd0\u884cClient\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"\u4e0b\u9762\uff0c\u6211\u4eec\u8fd0\u884cClient\u7684\u4ee3\u7801\uff0c\u6253\u5370\u7684\u7ed3\u679c\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"is PC\n\u521d\u59cb\u5316WebGL2\n\u5ef6\u8fdf\u6e32\u67d3\ntonemap for WebGL2\n")),(0,i.kt)("p",null,"\u6253\u5370\u7ed3\u679c\u8ddf\u4e4b\u524d\u4e00\u6837"),(0,i.kt)("h3",{id:"\u63d0\u51fa\u95ee\u9898-1"},"\u63d0\u51fa\u95ee\u9898"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4e0d\u80fd\u901a\u8fc7\u914d\u7f6e\u6765\u6307\u5b9a\u521d\u59cb\u5316\u548c\u6e32\u67d3\u7684\u6b65\u9aa4",(0,i.kt)("br",{parentName:"li"}),"\u73b0\u5728\u662f\u901a\u8fc7\u51fd\u6570\u8c03\u7528\u7684\u65b9\u5f0f\u6765\u6267\u884c\u6bcf\u4e2a\u6b65\u9aa4\u3002\u5982\u679c\u4e0d\u61c2\u4ee3\u7801\u7684\u7b56\u5212\u4eba\u5458\u60f3\u8981\u81ea\u5b9a\u4e49\u5404\u4e2a\u6b65\u9aa4\u7684\u6267\u884c\u987a\u5e8f\uff0c\u90a3\u4e48\u4ed6\u4e0d\u80fd\u76f4\u63a5\u901a\u8fc7\u4fee\u6539\u914d\u7f6e\u6570\u636e\u6765\u5b9e\u73b0\uff0c\u800c\u9700\u8981\u901a\u8fc7\u9ebb\u70e6\u5f00\u53d1\u4eba\u5458\u4fee\u6539\u4ee3\u7801\u6765\u5b9e\u73b0")),(0,i.kt)("h2",{id:"\u4f7f\u7528\u7ba1\u9053\u6a21\u5f0f\u6765\u6539\u8fdb"},"\u4f7f\u7528\u7ba1\u9053\u6a21\u5f0f\u6765\u6539\u8fdb"),(0,i.kt)("h3",{id:"\u6982\u8ff0\u89e3\u51b3\u65b9\u6848-1"},"\u6982\u8ff0\u89e3\u51b3\u65b9\u6848"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5c06EngineInPC\u548cEngineInMobile\u6539\u4e3a\u4e09\u4e2a\u7ba1\u9053\u6a21\u5757",(0,i.kt)("br",{parentName:"li"}),"\u5b83\u4eec\u5206\u522b\u662f\uff1aEngineInPCPipeline\u3001JiaEngineInMobilePipeline\u3001YiEngineInMobilePipeline\uff0c\u5176\u4e2d\u524d\u4e24\u4e2a\u7531\u7532\u8d1f\u8d23\uff0c\u6700\u540e\u4e00\u4e2a\u7531\u4e59\u8d1f\u8d23"),(0,i.kt)("li",{parentName:"ul"},"\u5c06\u6bcf\u4e2a\u6b65\u9aa4\u6a21\u5757\u6539\u4e3a\u4e00\u4e2aJob"),(0,i.kt)("li",{parentName:"ul"},"\u6bcf\u4e2a\u7ba1\u9053\u6a21\u5757\u90fd\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u7ba1\u9053\uff0c\u6bcf\u4e2a\u7ba1\u9053\u6709\u591a\u4e2aJob"),(0,i.kt)("li",{parentName:"ul"},"\u6bcf\u4e2a\u7ba1\u9053\u6a21\u5757\u90fd\u5b9a\u4e49\u4e86\u81ea\u5df1\u7684JSON\u914d\u7f6e\uff0c\u7528\u6765\u6307\u5b9aJob\u7684\u6267\u884c\u987a\u5e8f")),(0,i.kt)("h3",{id:"\u7ed9\u51fauml-2"},"\u7ed9\u51faUML"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u9886\u57df\u6a21\u578b")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"\u9886\u57df\u6a21\u578b\u56fe",src:t(3976).Z})),(0,i.kt)("p",null,"\u603b\u4f53\u6765\u770b\uff0c\u9886\u57df\u6a21\u578b\u5206\u4e3a\u7528\u6237\u3001Engine\u3001\u7ba1\u9053\u7ba1\u7406\u3001\u4e09\u4e2a\u7ba1\u9053\u6a21\u5757\u8fd9\u56db\u4e2a\u90e8\u5206"),(0,i.kt)("p",null,"\u6211\u4eec\u770b\u4e0b\u7528\u6237\u3001Engine\u8fd9\u4e24\u4e2a\u90e8\u5206\uff1a"),(0,i.kt)("p",null,"Client\u662f\u7528\u6237"),(0,i.kt)("p",null,"Engine\u662f\u5f15\u64ce\u95e8\u6237\uff0c\u4e0b\u9762\u4ecb\u7ecd\u5b83\u7684\u51fd\u6570\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","Engine\u7684createState\u51fd\u6570\u521b\u5efa\u4e86EngineState\uff1bEngine\u7684registerAllPipelines\u51fd\u6570\u6309\u7167\u4e0d\u540c\u7684\u8fd0\u884c\u73af\u5883\u6ce8\u518c\u4e86\u5bf9\u5e94\u7684\u7ba1\u9053\u6a21\u5757\uff1bEngine\u7684init\u51fd\u6570\u8fd0\u884c\u4e86\u6ce8\u518c\u7684\u7ba1\u9053\u6a21\u5757\u7684Init Pipeline\u7ba1\u9053\uff0c\u4f9d\u6b21\u6267\u884c\u5b83\u6240\u6709\u7684Job\uff0c\u5b9e\u73b0\u4e86\u521d\u59cb\u5316\uff1bEngine\u7684rende\u51fd\u6570\u8fd0\u884c\u4e86\u6ce8\u518c\u7684\u7ba1\u9053\u6a21\u5757\u7684Render Pipeline\u7ba1\u9053\uff0c\u4f9d\u6b21\u6267\u884c\u5b83\u6240\u6709\u7684Job\uff0c\u5b9e\u73b0\u4e86\u6e32\u67d3"),(0,i.kt)("p",null,"\u6211\u4eec\u770b\u4e0b\u7ba1\u9053\u7ba1\u7406\u8fd9\u4e2a\u90e8\u5206\uff1a"),(0,i.kt)("p",null,"PipelineManager\u8d1f\u8d23\u7ba1\u7406\u7ba1\u9053\uff0c\u5b9e\u73b0\u4e86\u6ce8\u518c\u7ba1\u9053\u3001\u5408\u5e76\u7ba1\u9053\u3001\u8fd0\u884c\u7ba1\u9053\u7684\u903b\u8f91"),(0,i.kt)("p",null,"\u6211\u4eec\u770b\u4e0b\u4e09\u4e2a\u7ba1\u9053\u6a21\u5757\u8fd9\u4e2a\u90e8\u5206\uff1a"),(0,i.kt)("p",null,"\u8fd9\u4e2a\u90e8\u5206\u5305\u62ec\u4e86\u4e09\u4e2a\u7ba1\u9053\u6a21\u5757\u3001\u7ba1\u9053\u6a21\u5757\u7684PipelineState\u548c\u5176\u7c7b\u578b\u5b9a\u4e49\uff08PipelineStateType\uff09\u3001\u7ba1\u9053\u6a21\u5757\u7684\u7ba1\u9053\u3001\u7ba1\u9053\u7684Job\u3002\u4e09\u4e2a\u7ba1\u9053\u6a21\u5757\u5177\u4f53\u662f\u7532\u8d1f\u8d23\u7684EngineInPCPipeline\u3001JiaEngineInMobilePipeline\u548c\u4e59\u8d1f\u8d23\u7684YiEngineInMobilePipeline\u3002\u6bcf\u4e2a\u7ba1\u9053\u6a21\u5757\u90fd\u6709\u81ea\u5df1\u7684PipelineState\uff0c\u7528\u6765\u4fdd\u5b58\u7ba1\u9053\u7684\u6240\u6709\u6570\u636e\uff0c\u5b83\u4eec\u5177\u4f53\u662fEngineInPCPipelineState\u3001JiaEngineInMobilePipelineState\u3001YiEngineInMobilePipelineState\u3002\u6bcf\u4e2aPipelineState\u5b9e\u73b0\u4e86\u5b9a\u4e49\u5728\u5bf9\u5e94\u7684PipelineStateType\u4e2d\u7684\u7c7b\u578b\uff0c\u8fd9\u4e9b\u7c7b\u578b\u5177\u4f53\u662fEngineInPCPipelineStateType\u3001JiaEngineInMobilePipelineStateType\u3001YiEngineInMobilePipelineStateType"),(0,i.kt)("p",null,"\u6bcf\u4e2a\u7ba1\u9053\u6a21\u5757\u6709\u591a\u4e2a\u7ba1\u9053\uff0c\u8fd9\u4e9b\u7ba1\u9053\u7684\u6570\u636e\u90fd\u4fdd\u5b58\u5728\u5b83\u7684PipelineState\u4e2d\u3002\u5177\u4f53\u6765\u8bf4\uff0cEngineInPCPipeline\u6709\u4e00\u4e2aInit Pipeline\u548c\u4e00\u4e2aRender Pipeline\uff0cJiaEngineInMobilePipeline\u6709\u4e00\u4e2aInit Pipeline\u548c\u4e00\u4e2aRender Pipeline\uff0cYiEngineInMobilePipeline\u6709\u4e00\u4e2aRender Pipeline"),(0,i.kt)("p",null,"\u4e4b\u524d\u7684\u6b65\u9aa4\u6a21\u5757\u73b0\u5728\u90fd\u5bf9\u5e94\u5730\u6539\u4e3aJob\uff0c\u6bcf\u4e2a\u7ba1\u9053\u53ef\u4ee5\u6709\u591a\u4e2aJob"),(0,i.kt)("p",null,"\u6211\u4eec\u6765\u770b\u4e0b\u4f9d\u8d56\u5173\u7cfb\uff1a"),(0,i.kt)("p",null,"\u6bcf\u4e2aJob\u90fd\u80fd\u8bfb\u5199",(0,i.kt)("strong",{parentName:"p"},"\u6240\u6709"),"\u7ba1\u9053\u6a21\u5757\u7684PipelineState\uff0c\u4f46\u5b83\u4eec\u6ca1\u6709\u76f4\u63a5\u4f9d\u8d56PipelineState\uff0c\u800c\u662f\u4f9d\u8d56\u5b83\u7684\u7c7b\u578b\uff08PipelineStateType\uff09\uff0c\u5982\u9886\u57df\u6a21\u578b\u4e2dEngineInPCPipeline\u7684Render Pipeline\u7ba1\u9053\u7684\u4e24\u4e2aJob\u4f9d\u8d56\u4e86EngineInPCPipeineStateType\uff0c\u8fd9\u662f\u56e0\u4e3a\u5b83\u4eec\u9700\u8981\u8bfb\u5199EngineInPCPipelineState\u3002\u5f53\u7136\u5b83\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4f9d\u8d56\u53e6\u5916\u4e24\u4e2a\u7ba1\u9053\u6a21\u5757\u7684PipelineStateType\u6765\u8bfb\u5199\u53e6\u5916\u4e24\u4e2a\u7ba1\u9053\u6a21\u5757\u7684PipelineState\uff0c\u53ea\u662f\u76ee\u524d\u6ca1\u6709\u5fc5\u8981",(0,i.kt)("br",{parentName:"p"}),"\n","\u540c\u7406\uff0cYiEngineInMobilePipeline\u7684Render Pipeline\u7ba1\u9053\u7684TonemapJob\u4f9d\u8d56\u4e86YiEngineInMobilePipelineStateType\u548cJiaEngineInMobilePipelineStateType\uff0c\u8fd9\u662f\u56e0\u4e3a\u5b83\u4eec\u9700\u8981\u8bfb\u5199YiEngineInMobilePipeline\u3001JiaEngineInMobilePipeline\u8fd9\u4e24\u4e2a\u7ba1\u9053\u6a21\u5757\u7684PipelineState",(0,i.kt)("br",{parentName:"p"}),"\n","\u53e6\u5916\uff0cYiEngineInMobilePipelineStateType\u4f9d\u8d56\u4e86JiaEngineInMobilePipelineStateType\uff0c\u8fd9\u662f\u56e0\u4e3aYiEngineInMobilePipelineStateType\u7684states\u7c7b\u578b\u9700\u8981\u5305\u62ecJiaEngineInMobilePipelineStateType\u7684state\uff0c\u4ece\u800c\u8ba9YiEngineInMobilePipeline\u4e2d\u7684TonemapJob\u80fd\u591f\u901a\u8fc7\u5b83\u6765\u83b7\u5f97YiEngineInMobilePipelineState\u548cJiaEngineInMobilePipelineState\u7684\u7c7b\u578b"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6570\u636e\u89c6\u56fe")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"\u6570\u636e\u89c6\u56fe",src:t(2948).Z})),(0,i.kt)("p",null,"\u603b\u4f53\u6765\u770b\uff0c\u6570\u636e\u5206\u4e3a\u8fd0\u884c\u65f6\u6570\u636e\u548c\u914d\u7f6e\u6570\u636e\uff0c\u5176\u4e2d\u5404\u4e2aState\u5c5e\u4e8e\u8fd0\u884c\u65f6\u6570\u636e\uff0c\u5404\u4e2aJSON\u5c5e\u4e8e\u914d\u7f6e\u6570\u636e"),(0,i.kt)("p",null,"Engine\u6709\u81ea\u5df1\u7684\u6570\u636e-EngineState\uff0c\u5b83\u5305\u62ec\u4e86\u5176\u5b83\u6240\u6709\u7684state"),(0,i.kt)("p",null,"PipelineManager\u6709\u81ea\u5df1\u7684\u6570\u636e-PipelineManagerState\uff0c\u5b83\u5305\u62ec\u4e86\u6240\u6709\u7ba1\u9053\u6a21\u5757\u7684PipelineState"),(0,i.kt)("p",null,"\u4e09\u4e2a\u7ba1\u9053\u6a21\u5757\u5404\u81ea\u6709\u4e00\u4e2aPipelineState\u6570\u636e\u548c\u4e00\u4e2aJSON\u914d\u7f6e\u6570\u636e\uff0c\u5176\u4e2dPipelineState\u4fdd\u5b58\u4e86\u7ba1\u9053\u6a21\u5757\u4e2d\u6240\u6709\u7ba1\u9053\u7684\u8fd0\u884c\u65f6\u6570\u636e\uff0cJSON\u914d\u7f6e\u6570\u636e\u7528\u6765\u6307\u5b9a\u7ba1\u9053\u6a21\u5757\u4e2d\u6240\u6709\u7ba1\u9053\u7684Job\u7684\u6267\u884c\u987a\u5e8f"),(0,i.kt)("h3",{id:"\u7ed3\u5408uml\u56fe\u63cf\u8ff0\u5982\u4f55\u5177\u4f53\u5730\u89e3\u51b3\u95ee\u9898-1"},"\u7ed3\u5408UML\u56fe\uff0c\u63cf\u8ff0\u5982\u4f55\u5177\u4f53\u5730\u89e3\u51b3\u95ee\u9898"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"EngineInPCPipeline\u3001JiaEngineInMobilePipeline\u3001YiEngineInMobilePipeline\u8fd9\u4e09\u4e2a\u7ba1\u9053\u6a21\u5757\u90fd\u6709\u81ea\u5df1\u7684JSON\u914d\u7f6e\u6570\u636e\uff0c\u4e0d\u61c2\u5f00\u53d1\u7684\u7b56\u5212\u4eba\u5458\u53ea\u9700\u8981\u914d\u7f6e\u5b83\u4eec\u800c\u4e0d\u9700\u8981\u4fee\u6539\u4ee3\u7801\uff0c\u5373\u53ef\u6307\u5b9a\u521d\u59cb\u5316\u548c\u6e32\u67d3\u7684\u6b65\u9aa4")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u73b0\u5728\u7532\u3001\u4e59\u4e4b\u95f4\u7684\u5f00\u53d1\u66f4\u52a0\u89e3\u8026\u4e86\uff0c\u8fdb\u4e00\u6b65\u51cf\u5c11\u4e86\u4e24\u4eba\u7684\u76f8\u4e92\u5f71\u54cd",(0,i.kt)("br",{parentName:"p"}),"\n","\u7532\u548c\u4e59\u5f00\u53d1\u7684\u662f\u4e0d\u540c\u7684\u7ba1\u9053\uff0c\u5b83\u4eec\u4e4b\u95f4\u552f\u4e00\u7684\u4f9d\u8d56\u662f\u4e59\u5f00\u53d1\u7684\u7ba1\u9053\u6a21\u5757\uff08YiEngineInMobilePipeline\uff09\u7684PipelineState\uff08YiEngineInMobilePipelineState\uff09\u548cJob\uff08TonemapJob\uff09\u4f7f\u7528\u4e86\u7532\u5f00\u53d1\u7684\u7ba1\u9053\u6a21\u5757\u7684PipelineState\uff08JiaEngineInMobilePipelineState\uff09\u3002\u4f46\u662f\u56e0\u4e3a\u5b83\u4eec\u7684\u4f9d\u8d56\u662f\u7c7b\u578b\uff08PipelineStateType\uff09\u4e4b\u95f4\u7684\u4f9d\u8d56\uff0c\u6240\u4ee5\u53ea\u8981JiaEngineInMobilePipelineStateType\u4e0d\u53d8\uff08\u7c7b\u578b\u662f\u62bd\u8c61\u7684\uff0c\u4e00\u822c\u90fd\u4e0d\u4f1a\u6539\u53d8\uff09\uff0c\u5219\u7532\u3001\u4e59\u4e4b\u95f4\u7684\u5f00\u53d1\u5c31\u4e0d\u4f1a\u4e92\u76f8\u5f71\u54cd"))),(0,i.kt)("h3",{id:"\u7ed9\u51fa\u4ee3\u7801-2"},"\u7ed9\u51fa\u4ee3\u7801"),(0,i.kt)("p",null,"\u9996\u5148\uff0c\u6211\u4eec\u770b\u4e0bClient\u7684\u4ee3\u7801\uff1b"),(0,i.kt)("p",null,"\u7136\u540e\uff0c\u6211\u4eec\u4f9d\u6b21\u770b\u4e0bClient\u4ee3\u7801\u4e2d\u6bcf\u4e2a\u6b65\u9aa4\u7684\u4ee3\u7801\uff0c\u5b83\u4eec\u5305\u62ec\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u521b\u5efaEngineState\u7684\u4ee3\u7801"),(0,i.kt)("li",{parentName:"ul"},"\u6ce8\u518c\u7ba1\u9053\u6a21\u5757\u7684\u4ee3\u7801"),(0,i.kt)("li",{parentName:"ul"},"Engine\u7684init\u51fd\u6570\u7684\u4ee3\u7801"),(0,i.kt)("li",{parentName:"ul"},"Engine\u7684render\u51fd\u6570\u7684\u4ee3\u7801")),(0,i.kt)("p",null,"\u7136\u540e\uff0c\u6211\u4eec\u770b\u4e0b\u79fb\u52a8\u7aef\u6ce8\u518c\u7684\u7ba1\u9053\u6a21\u5757\u7684\u76f8\u5173\u4ee3\u7801\uff0c\u5b83\u4eec\u5305\u62ec\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"JiaEngineInMobilePipeline\u7684\u76f8\u5173\u4ee3\u7801"),(0,i.kt)("li",{parentName:"ul"},"YiEngineInMobilePipeline\u7684\u76f8\u5173\u4ee3\u7801")),(0,i.kt)("p",null,"\u7136\u540e\uff0c\u56e0\u4e3a\u6ce8\u518c\u7684\u7ba1\u9053\u6a21\u5757\u6709\u540c\u540d\u7684\u7ba1\u9053\uff0c\u9700\u8981\u5408\u5e76\u5b83\u4eec\uff0c\u6240\u4ee5\u6211\u4eec\u770b\u4e0b\u76f8\u5173\u4ee3\u7801\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u79fb\u52a8\u7aef\u5408\u5e76Render Pipeline\u7684\u76f8\u5173\u4ee3\u7801")),(0,i.kt)("p",null,"\u7136\u540e\uff0c\u6211\u4eec\u770b\u4e0bPC\u7aef\u6ce8\u518c\u7684\u7ba1\u9053\u6a21\u5757\u7684\u76f8\u5173\u4ee3\u7801\uff0c\u5b83\u4eec\u5305\u62ec\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"EngineInPCPipeline\u7684\u76f8\u5173\u4ee3\u7801\uff1b")),(0,i.kt)("p",null,"\u6700\u540e\uff0c\u6211\u4eec\u8fd0\u884cClient\u7684\u4ee3\u7801"),(0,i.kt)("h4",{id:"client\u7684\u4ee3\u7801-2"},"Client\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"Client"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"...\n\nlet engineState = Engine.createState()\n\nengineState = Engine.registerAllPipelines(engineState)\n\n...\n")),(0,i.kt)("p",null,"Client\u4ee3\u7801\u8ddf\u4e4b\u524d\u57fa\u672c\u4e0a\u4e00\u6837\uff0c\u53ea\u662f\u591a\u51fa\u4e86\u8c03\u7528registerAllPipelines\u51fd\u6570\u6765\u6ce8\u518c\u7ba1\u9053\u6a21\u5757\u7684\u8fd9\u4e00\u6b65\u4ee3\u7801"),(0,i.kt)("h4",{id:"\u521b\u5efaenginestate\u7684\u4ee3\u7801-1"},"\u521b\u5efaEngineState\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"Engine"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export let createState = (): state => {\n    return {\n        pipelineManagerState: PipelineManager.createState()\n    }\n}\n")),(0,i.kt)("p",null,"createState\u51fd\u6570\u521b\u5efa\u7684EngineState\u4fdd\u5b58\u4e86\u521b\u5efa\u7684PipelineManagerState\uff0c\u800cPipelineManagerState\u4fdd\u5b58\u4e86\u6240\u6709\u7ba1\u9053\u7684\u6570\u636e"),(0,i.kt)("h4",{id:"\u6ce8\u518c\u7ba1\u9053\u6a21\u5757\u7684\u4ee3\u7801"},"\u6ce8\u518c\u7ba1\u9053\u6a21\u5757\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"Engine"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export let registerAllPipelines = (state: state) => {\n    if (_isPC()) {\n        let pipelineManagerState = PipelineManager.registerPipeline(\n            state.pipelineManagerState,\n            EngineInPCPipeline.getPipeline(),\n            []\n        )\n\n        state = {\n            ...state,\n            pipelineManagerState: pipelineManagerState\n        }\n    }\n    else {\n        let pipelineManagerState = PipelineManager.registerPipeline(\n            state.pipelineManagerState,\n            JiaEngineInMobilePipeline.getPipeline(),\n            []\n        )\n        pipelineManagerState = PipelineManager.registerPipeline(\n            pipelineManagerState,\n            YiEngineInMobilePipeline.getPipeline(),\n            [\n                {\n                    pipelineName: "render",\n                    insertElementName: "forward_render_jia_engineInMobile",\n                    insertAction: "after"\n                }\n            ]\n        )\n\n        state = {\n            ...state,\n            pipelineManagerState: pipelineManagerState\n        }\n    }\n\n    return state\n}\n')),(0,i.kt)("p",null,"registerAllPipelines\u51fd\u6570\u6ce8\u518c\u4e86\u7ba1\u9053\u6a21\u5757\uff0c\u5b83\u5224\u65ad\u8fd0\u884c\u73af\u5883\uff0c\u6ce8\u518c\u5bf9\u5e94\u7684\u7ba1\u9053\u6a21\u5757\uff0c\u5177\u4f53\u5982\u4e0b\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5982\u679c\u662fPC\u7aef\uff0c\u5c31\u6ce8\u518cEngineInPCPipeline\uff1b"),(0,i.kt)("li",{parentName:"ul"},"\u5982\u679c\u662f\u79fb\u52a8\u7aef\uff0c\u5c31\u6ce8\u518cJiaEngineInMobilePipeline\u3001YiEngineInMobilePipeline")),(0,i.kt)("p",null,"\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","\u79fb\u52a8\u7aef\u7684\u6ce8\u518c\u4f1a\u5408\u5e76JiaEngineInMobilePipeline\u3001YiEngineInMobilePipeline\u8fd9\u4e24\u4e2a\u7ba1\u9053\u6a21\u5757\u4e2d\u540c\u540d\u7684\u7ba1\u9053\uff0c\u5177\u4f53\u5c31\u662f\u5c06\u5b83\u4eec\u7684Render Pipeline\u5408\u5e76\u4e3a\u4e00\u4e2aRender Pipeline"),(0,i.kt)("p",null,"registerAllPipelines\u51fd\u6570\u8c03\u7528\u4e86PipelineManager\u7684registerPipeline\u51fd\u6570\u6765\u6ce8\u518c\u7ba1\u9053\u6a21\u5757\uff0c\u5b83\u63a5\u6536\u4e09\u4e2a\u53c2\u6570\uff0c\u8fd4\u56de\u65b0\u7684PipelineManagerState\u3002\u63a5\u6536\u7684\u4e09\u4e2a\u53c2\u6570\u5206\u522b\u4e3aPipelineManagerState\u3001\u7ba1\u9053\u6a21\u5757\u7684\u6a21\u5757\u6570\u636e\u3001JobOrders\uff0c\u5176\u4e2d\uff0cJobOrders\u7528\u6765\u6307\u5b9a\u5982\u4f55\u5408\u5e76\u7ba1\u9053\u6a21\u5757\u7684\u7ba1\u9053\uff0c\u540e\u9762\u518d\u8ba8\u8bba\uff1b\u7ba1\u9053\u6a21\u5757\u7684\u6a21\u5757\u6570\u636e\u662f\u901a\u8fc7\u8c03\u7528\u7ba1\u9053\u6a21\u5757\u7684getPipeline\u51fd\u6570\u83b7\u5f97\u7684"),(0,i.kt)("h4",{id:"engine\u7684init\u51fd\u6570\u7684\u4ee3\u7801-1"},"Engine\u7684init\u51fd\u6570\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"Engine"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export let init = (state: state, canvas): Promise<state> => {\n    \u521d\u59cb\u5316\u7ba1\u9053\n\n    //\u5c06canvas\u4fdd\u5b58\u5230\u5168\u5c40\u53d8\u91cf\u4e2d\uff0c\u4ece\u800c\u5728Job\u4e2d\u901a\u8fc7\u5168\u5c40\u53d8\u91cf\u80fd\u591f\u83b7\u5f97canvas\n    globalThis.canvas = canvas\n\n    \u8fd0\u884cInit Pipeline\u7ba1\u9053\n}\n")),(0,i.kt)("p",null,"init\u51fd\u6570\u5b9e\u73b0\u4e86\u5f15\u64ce\u7684\u521d\u59cb\u5316"),(0,i.kt)("p",null,"\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","init\u51fd\u6570\u5c06\u7528\u6237Client\u4f20\u8fc7\u6765\u7684\u914d\u7f6e\u6570\u636e\uff08\u8fd9\u91cc\u662fcanvas\uff09\u4fdd\u5b58\u5230\u4e86\u5168\u5c40\u53d8\u91cf\u4e2d\uff0c\u4ece\u800c\u4f7f\u5f97Job\u80fd\u591f\u901a\u8fc7\u5168\u5c40\u53d8\u91cf\u83b7\u5f97\u8fd9\u4e9b\u914d\u7f6e\u6570\u636e"),(0,i.kt)("h4",{id:"engine\u7684render\u51fd\u6570\u7684\u4ee3\u7801-1"},"Engine\u7684render\u51fd\u6570\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"Engine"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export let render = (state: state): Promise<state> => {\n    \u8fd0\u884cRender Pipeline\u7ba1\u9053\n}\n")),(0,i.kt)("p",null,"render\u51fd\u6570\u5b9e\u73b0\u4e86\u5f15\u64ce\u7684\u6e32\u67d3"),(0,i.kt)("h4",{id:"jiaengineinmobilepipeline\u7684\u76f8\u5173\u4ee3\u7801"},"JiaEngineInMobilePipeline\u7684\u76f8\u5173\u4ee3\u7801"),(0,i.kt)("p",null,"JiaEngineInMobilePipelineStateType"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export const pipelineName = "JiaEngineInMobile"\n\n//JiaEngineInMobilePipelineState\u7684\u7c7b\u578b\nexport type state = {\n    gl: WebGLRenderingContext | null\n}\n\n//states\u5b9a\u4e49\u4e86\u5728JiaEngineInMobilePipeline\u7684\u6240\u6709\u7684Job\u4e2d\u9700\u8981\u8c03\u7528\u7684\u6240\u6709\u7684PipelineState\u7684\u7c7b\u578b\n//\u56e0\u4e3a\u76ee\u524d\u53ea\u9700\u8981\u8c03\u7528JiaEngineInMobilePipelineState\uff0c\u6240\u4ee5\u53ea\u5b9a\u4e49\u4e86\u5b83\u7684\u7c7b\u578b\nexport type states = {\n    [pipelineName]: state,\n}\n\n')),(0,i.kt)("p",null,"JiaEngineInMobilePipelineStateType\u5b9a\u4e49\u4e86JiaEngineInMobilePipelineState\u76f8\u5173\u7684\u7c7b\u578b"),(0,i.kt)("p",null,"JiaEngineInMobilePipeline"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'//\u8fd4\u56deJob\u7684exec\u51fd\u6570\nlet _getExec = (_pipelineName: string, jobName: string) => {\n    switch (jobName) {\n        case "init_webgl1_jia_engineInMobile":\n            return InitWebGL1Job.exec\n        case "forward_render_jia_engineInMobile":\n            return ForwardRenderJob.exec\n        default:\n            return null\n    }\n}\n\n//\u83b7\u5f97\u7ba1\u9053\u6a21\u5757\u7684\u6a21\u5757\u6570\u636e\nexport let getPipeline = (): ... => {\n    return {\n        ...\n        //\u521b\u5efaJiaEngineInMobilePipelineState\n        createState: engineState => {\n            return {\n                gl: null\n            }\n        },\n        //getExec\u5173\u8054\u4e86allPipelineData\u4e2d\u7684type\u4e3ajob\u7684element\u7684name\u4e0eJob\n        getExec: _getExec,\n        //allPipelineData\u662fJSON\u914d\u7f6e\u6570\u636e\uff0c\u7528\u6765\u6307\u5b9aJob\u7684\u6267\u884c\u987a\u5e8f\n        //\u5b83\u5305\u62ec\u6240\u6709\u7ba1\u9053\u7684\u914d\u7f6e\u6570\u636e\n        allPipelineData: [\n            //Init Pipeline\u7ba1\u9053\u914d\u7f6e\u6570\u636e\n            {\n                //\u7ba1\u9053\u540d\n                name: "init",\n                //groups\u5305\u62ec\u6240\u6709\u7684group\uff0c\u76ee\u524d\u53ea\u6709\u4e00\u4e2agroup\n                groups: [\n                    {\n                        //group\u540d\n                        name: "first_jia_engineInMobile",\n                        //link\u6307\u5b9a\u4e86\u8be5group\u7684\u6240\u6709element\u4e4b\u95f4\u7684\u94fe\u63a5\u65b9\u5f0f\n                        //\u6709\u4e24\u79cd\u94fe\u63a5\u65b9\u5f0f\uff1aconcat\u6216\u8005merge\n                        //concat\u662f\u6307\u6bcf\u4e2aelement\u4e32\u884c\u6267\u884c\n                        //merge\u662f\u6307\u6bcf\u4e2aelement\u5e76\u884c\u6267\u884c\n                        link: "concat",\n                        //element\u7684\u7c7b\u578b\u53ef\u4ee5\u4e3ajob\u6216\u8005group\n                        //\u76ee\u524d\u53ea\u6709\u4e00\u4e2a\u7c7b\u578b\u4e3ajob\u7684element\n                        elements: [\n                            {\n                                "name": "init_webgl1_jia_engineInMobile",\n                                "type_": "job"\n                            }\n                        ]\n                    }\n                ],\n                //\u8fd0\u884c\u8be5\u7ba1\u9053\u65f6\u9996\u5148\u6267\u884c\u7684group\u540d\n                first_group: "first_jia_engineInMobile"\n            },\n            //Render Pipeline\u7ba1\u9053\u914d\u7f6e\u6570\u636e\n            {\n                name: "render",\n                groups: [\n                    {\n                        name: "first_jia_engineInMobile",\n                        link: "concat",\n                        elements: [\n                            {\n                                "name": "forward_render_jia_engineInMobile",\n                                "type_": "job"\n                            },\n                        ]\n                    }\n                ],\n                first_group: "first_jia_engineInMobile"\n            }\n        ]\n    }\n}\n')),(0,i.kt)("p",null,"JiaEngineInMobilePipeline\u6709\u4e00\u4e2aInit Pipeline\u548c\u4e00\u4e2aRender Pipeline\uff0c\u5176\u4e2dInit Pipeline\u53ea\u6709\u4e00\u4e2aJob\uff1aInitWebGL1Job\uff0cRender Pipeline\u53ea\u6709\u4e00\u4e2aJob\uff1aForwardRenderJob"),(0,i.kt)("p",null,"\u6211\u4eec\u770b\u4e0bJob\u7684\u76f8\u5173\u4ee3\u7801\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","InitWebGL1Job"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export let exec: ... = (engineState, ...) => {\n    ...\n\n    //\u4ece\u5168\u5c40\u53d8\u91cf\u4e2d\u83b7\u5f97canvas\n    let canvas: HTMLCanvasElement = globalThis.canvas\n\n    //\u8c03\u7528most.js\u5e93\uff0c\u8fd4\u56de\u4e86\u4e00\u4e2a\u6d41\n    return mostService.callFunc(() => {\n        console.log("\u521d\u59cb\u5316WebGL1")\n\n        let gl = canvas.getContext("webgl")\n\n        \u5c06gl\u4fdd\u5b58\u5230EngineState\u7684JiaEngineInMobilePipelineState\u4e2d\n    })\n}\n')),(0,i.kt)("p",null,"ForwardRenderJob"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export let exec: ... = (engineState, ...) => {\n    ...\n\n    return mostService.callFunc(() => {\n        gl = \u4eceEngineState\u4e2d\u83b7\u5f97JiaEngineInMobilePipelineState\uff0c\u5e76\u83b7\u5f97\u5b83\u7684gl\n\n        console.log("\u524d\u5411\u6e32\u67d3")\n\n        return engineState\n    })\n}\n')),(0,i.kt)("p",null,"\u867d\u7136\u8fd9\u4e2aJob\u53ea\u6709\u540c\u6b65\u64cd\u4f5c\uff0c\u4f46\u662fJob\u5176\u5b9e\u53ef\u80fd\u4f1a\u8fdb\u884c\u5f02\u6b65\u64cd\u4f5c\u7684\uff08\u5982\u4e0eGPU\u7684\u64cd\u4f5c\u53ef\u80fd\u662f\u5f02\u6b65\u64cd\u4f5c\uff09\u3002\u5904\u7406\u5f02\u6b65\u4e00\u822c\u6709\u4e24\u79cd\u65b9\u6cd5\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","1.\u901a\u8fc7Async\u3001Await\u5173\u952e\u5b57\uff0c\u5c06\u5f02\u6b65\u8f6c\u6362\u4e3a\u540c\u6b65",(0,i.kt)("br",{parentName:"p"}),"\n","2.\u4f7f\u7528Promise"),(0,i.kt)("p",null,"\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u7b2c\u4e09\u79cd\u65b9\u6cd5\uff1a\u57fa\u4e8eFRP\uff08\u51fd\u6570\u53cd\u5e94\u578b\u7f16\u7a0b\uff09\uff0c\u4f7f\u7528\u6d41\u6765\u5904\u7406\u5f02\u6b65\u64cd\u4f5c\u3002\u5177\u4f53\u662f\u8ba9\u6bcf\u4e2aJob\u90fd\u8fd4\u56de\u4e00\u4e2a\u6d41\uff0c\u5728\u6d41\u7684\u5904\u7406\u51fd\u6570\uff08\u5373callFunc\u51fd\u6570\uff09\u4e2d\u6267\u884cJob\u7684\u903b\u8f91\u3002\u8fd9\u6837\u505a\u7684\u4e00\u4e2a\u597d\u5904\u662f\u80fd\u591f\u8f7b\u6613\u5b9e\u73b0\u4e32\u884c\u6216\u8005\u5e76\u884c\u7684Job\uff08\u5f53JSON\u914d\u7f6e\u6570\u636e\u7684link\u5b57\u6bb5\u4e3aconcat\u6216\u8005merge\u65f6\uff09\uff0c\u8fd9\u53ea\u9700\u8981\u5c06\u6bcf\u4e2aJob\u8fd4\u56de\u7684\u6d41concat\u6216\u8005merge\u5373\u53ef\u3002\u53e6\u4e00\u4e2a\u597d\u5904\u662f\u80fd\u591f\u8f7b\u6613\u5b9e\u73b0\u5408\u5e76\u7ba1\u9053\uff0c\u56e0\u4e3a\u4e00\u4e2a\u7ba1\u9053\u5c31\u662f\u4e00\u4e2a\u6d41\uff0c\u5408\u5e76\u7ba1\u9053\u5c31\u662f\u5408\u5e76\u6d41\uff0c\u5bb9\u6613\u5b9e\u73b0"),(0,i.kt)("p",null,"\u6211\u4eec\u8fd9\u91cc\u4f7f\u7528\u4e86most.js\u5e93\u6765\u5b9e\u73b0\u6d41\uff0c\u5b83\u662f\u4e00\u4e2a\u5f00\u6e90\u7684FRP\u5e93\uff0c\u76f8\u6bd4Rxjs\u5e93\u6027\u80fd\u8981\u66f4\u597d"),(0,i.kt)("h4",{id:"yiengineinmobilepipeline\u7684\u76f8\u5173\u4ee3\u7801"},"YiEngineInMobilePipeline\u7684\u76f8\u5173\u4ee3\u7801"),(0,i.kt)("p",null,"YiEngineInMobilePipelineStateType"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export const pipelineName = "YiEngineInMobile"\n\nexport type state = {\n}\n\nexport type states = {\n    [pipelineName]: state,\n    [jiaEngineInMobilePipelineName]: jiaEngineInMobilePipelineState,\n}\n')),(0,i.kt)("p",null,"YiEngineInMobilePipelineStateType\u5b9a\u4e49\u4e86YiEngineInMobilePipelineState\u76f8\u5173\u7684\u7c7b\u578b\u3002\u56e0\u4e3aYiEngineInMobilePipeline\u4e2d\u7684Job\u9700\u8981\u901a\u8fc7\u8fd9\u91cc\u7684states\u7c7b\u578b\u6765\u83b7\u5f97YiEngineInMobilePipelineState\u548cJiaEngineInMobilePipelineState\u7684\u7c7b\u578b\uff0c\u6240\u4ee5\u8fd9\u91cc\u7684states\u9700\u8981\u5b9a\u4e49YiEngineInMobilePipelineState\u4ee5\u53caJiaEngineInMobilePipelineState\u7684\u7c7b\u578b"),(0,i.kt)("p",null,"YiEngineInMobilePipeline"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"...\n\nexport let getPipeline = (): ... => {\n    return {\n        ...\n        createState: engineState => {\n            return {\n            }\n        },\n        ...\n        allPipelineData: [\n            //Render Pipeline\u7ba1\u9053\u914d\u7f6e\u6570\u636e\n            {\n                ...\n            }\n        ],\n    }\n}\n\n")),(0,i.kt)("p",null,"YiEngineInMobilePipeline\u53ea\u6709\u4e00\u4e2aRender Pipeline\u7ba1\u9053\uff0c\u5b83\u53ea\u6709\u4e00\u4e2aJob\uff1aTonemapJob"),(0,i.kt)("p",null,"Job\u7684\u76f8\u5173\u4ee3\u7801\u5982\u4e0b\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","TonemapJob"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export let exec: ... = (engineState, ...) => {\n    ...\n\n    return mostService.callFunc(() => {\n        gl = \u4eceEngineState\u4e2d\u83b7\u5f97JiaEngineInMobilePipelineState\uff0c\u5e76\u83b7\u5f97\u5b83\u7684gl\n\n        console.log("tonemap for WebGL1")\n\n        return engineState\n    })\n}\n')),(0,i.kt)("p",null,"\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","\u8fd9\u4e2aJob\u9700\u8981\u83b7\u5f97\u53e6\u4e00\u4e2a\u7ba1\u9053\u6a21\u5757\u7684PipelineState\uff08JiaEngineInMobilePipelineState\uff09\u7684gl"),(0,i.kt)("h4",{id:"\u79fb\u52a8\u7aef\u5408\u5e76render-pipeline\u7684\u76f8\u5173\u4ee3\u7801"},"\u79fb\u52a8\u7aef\u5408\u5e76Render Pipeline\u7684\u76f8\u5173\u4ee3\u7801"),(0,i.kt)("p",null,"\u79fb\u52a8\u7aef\u6ce8\u518c\u7684\u4e24\u4e2a\u7ba1\u9053\u6a21\u5757\u4e2d\u6709\u540c\u540d\u7684\u7ba1\u9053\uff1aRender Pipeline\u7ba1\u9053\uff0c\u9700\u8981\u5408\u5e76\u5b83\u4eec\u3002\u6211\u4eec\u56de\u987e\u4e0bEngine\u7684registerAllPipelines\u51fd\u6570\u4e2d\u5408\u5e76\u8fd9\u4e24\u4e2a\u7ba1\u9053\u7684\u76f8\u5173\u4ee3\u7801\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","Engine"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'        let pipelineManagerState = registerPipeline(\n            state.pipelineManagerState,\n            JiaEngineInMobilePipeline.getPipeline(),\n            []\n        )\n        pipelineManagerState = registerPipeline(\n            pipelineManagerState,\n            YiEngineInMobilePipeline.getPipeline(),\n            [\n                {\n                    pipelineName: "render",\n                    insertElementName: "forward_render_jia_engineInMobile",\n                    insertAction: "after"\n                }\n            ]\n        )\n')),(0,i.kt)("p",null,"\u6211\u4eec\u4e4b\u524d\u63d0\u5230registerPipeline\u51fd\u6570\u63a5\u6536\u7684\u7b2c\u4e09\u4e2a\u53c2\u6570-JobOrders\u7528\u6765\u6307\u5b9a\u5982\u4f55\u5408\u5e76\u7ba1\u9053\uff0c\u73b0\u5728\u6211\u4eec\u6765\u5177\u4f53\u770b\u4e00\u4e0b\u5b83\u7684\u7c7b\u578b\u5b9a\u4e49\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","PipelineManager->RegisterPipelineType"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export type insertAction = "before" | "after"\n\nexport type jobOrder = {\n  //\u7ba1\u9053\u540d\n  pipelineName: pipelineName,\n  //\u5c06\u8be5\u7ba1\u9053\u7684\u6240\u6709Job\u63d2\u5165\u5230\u67d0\u4e2aelement\u4e2d\uff08element\u53ef\u4ee5\u4e3ajob\u6216\u8005group\uff09\uff0c\u800c\u8fd9\u91cc\u7684insertElementName\u5c31\u662f\u8be5element\u7684\u540d\u79f0\n  insertElementName: elementName,\n  //\u503c\u53ef\u4ee5\u4e3abefore\u6216\u8005after\uff0c\u610f\u601d\u662f\u63d2\u5165\u5230\u8be5element\u4e4b\u524d\u6216\u8005\u4e4b\u540e\n  insertAction: insertAction,\n}\n\n//\u53ef\u80fd\u8981\u5408\u5e76\u591a\u79cd\u540c\u540d\u7ba1\u9053\uff0c\u6240\u4ee5jobOrders\u662f\u6570\u7ec4\uff0c\u6bcf\u4e2a\u6570\u7ec4\u5143\u7d20\u5bf9\u5e94\u4e00\u79cd\u540d\u5b57\u7684\u7ba1\u9053\nexport type jobOrders = Array<jobOrder>\n')),(0,i.kt)("p",null,"\u56e0\u4e3a\u8fd9\u91cc\u53ea\u9700\u8981\u5408\u5e76\u4e00\u79cd\u540c\u540d\u7ba1\u9053\uff1aRender Pipeline\uff0c\u6240\u4ee5jobOrders\u53ea\u5305\u542b\u4e00\u4e2ajobOrder"),(0,i.kt)("p",null,'Engine\u7684registerAllPipelines\u51fd\u6570\u5177\u4f53\u662f\u5c06YiEngineInMobilePipeline\u7684Render Pipeline\u7684\u6240\u6709\u7684Job\uff08\u4e5f\u5c31\u662fTonemapJob\uff09\u63d2\u5165\u5230JiaEngineInMobilePipeline\u7684Render Pipeline\u4e2d\u540d\u4e3a "forward_render_jia_engineInMobile"\u7684Job\uff08\u4e5f\u5c31\u662fForwardRenderJob\uff09\u4e4b\u540e\u6267\u884c\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u5728\u79fb\u52a8\u7aef\u53ea\u6709\u4e00\u4e2aInit Pipeline\u548c\u4e00\u4e2aRender Pipeline\u7ba1\u9053\uff0c\u5176\u4e2d\u524d\u8005\u6267\u884cInitWebGL1Job\uff0c\u540e\u8005\u4f9d\u6b21\u6267\u884cForwardRenderJob\u3001TonemapJob\u8fd9\u4e24\u4e2aJob'),(0,i.kt)("p",null,"\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","\u5408\u5e76\u540e\uff0cEngineState\u4e2d\u7684PipelineManagerState\u4e2d\u4ecd\u7136\u6709\u8fd9\u4e24\u4e2a\u7ba1\u9053\u6a21\u5757\u7684PipelineState\uff08\u5373JiaEngineInMobilePipelineState\u3001YiEngineInMobilePipelineState\uff09\uff0c\u800c\u4e0d\u662f\u53ea\u6709JiaEngineInMobilePipelineState"),(0,i.kt)("h4",{id:"engineinpcpipeline\u7684\u76f8\u5173\u4ee3\u7801"},"EngineInPCPipeline\u7684\u76f8\u5173\u4ee3\u7801"),(0,i.kt)("p",null,"EngineInPCPipelineStateType"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export const pipelineName = "EngineInPC"\n\nexport type state = {\n    gl: WebGL2RenderingContext | null\n}\n\nexport type states = {\n    [pipelineName]: state,\n}\n')),(0,i.kt)("p",null,"EngineInPCPipelineStateType\u5b9a\u4e49\u4e86EngineInPCPipelineState\u76f8\u5173\u7684\u7c7b\u578b"),(0,i.kt)("p",null,"EngineInPCPipeline"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"...\n\nexport let getPipeline = (): ... => {\n    return {\n        ...\n        createState: engineState => {\n            return {\n                gl: null\n            }\n        },\n        ...\n        allPipelineData: [\n            //Init Pipeline\u7ba1\u9053\u914d\u7f6e\u6570\u636e\n            {\n                ...\n            },\n            //Render Pipeline\u7ba1\u9053\u914d\u7f6e\u6570\u636e\n            {\n                ...\n            }\n\n        ],\n    }\n}\n")),(0,i.kt)("p",null,"EngineInPCPipeline\u6709\u4e00\u4e2aInit Pipeline\u548c\u4e00\u4e2aRender Pipeline\uff0c\u5176\u4e2dInit Pipeline\u53ea\u6709\u4e00\u4e2aJob\uff1aInitWebGL2Job\uff0cRender Pipeline\u6709\u4e24\u4e2aJob\uff1aDeferRenderJob\u3001TonemapJob"),(0,i.kt)("p",null,"\u6211\u4eec\u770b\u4e0bJob\u7684\u76f8\u5173\u4ee3\u7801\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","InitWebGL2Job"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export let exec: ... = (engineState, ...) => {\n    ...\n\n    //\u4ece\u5168\u5c40\u53d8\u91cf\u4e2d\u83b7\u5f97canvas\n    let canvas: HTMLCanvasElement = globalThis.canvas\n\n    //\u8c03\u7528most.js\u5e93\uff0c\u8fd4\u56de\u4e86\u4e00\u4e2a\u6d41\n    return mostService.callFunc(() => {\n        console.log("\u521d\u59cb\u5316WebGL2")\n\n        let gl = canvas.getContext("webgl2")\n\n        \u5c06gl\u4fdd\u5b58\u5230EngineState\u7684EngineInPCPipelineState\u4e2d\n    })\n}\n')),(0,i.kt)("p",null,"DeferRenderJob"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export let exec: ... = (engineState, ...) => {\n    ...\n\n    return mostService.callFunc(() => {\n        gl = \u4eceEngineState\u4e2d\u83b7\u5f97EngineInPCPipelineState\uff0c\u5e76\u83b7\u5f97\u5b83\u7684gl\n\n        console.log("\u5ef6\u8fdf\u6e32\u67d3")\n\n        return engineState\n    })\n}\n')),(0,i.kt)("p",null,"TonemapJob"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export let exec: ... = (engineState, ...) => {\n    ...\n\n    return mostService.callFunc(() => {\n        gl = \u4eceEngineState\u4e2d\u83b7\u5f97EngineInPCPipelineState\uff0c\u5e76\u83b7\u5f97\u5b83\u7684gl\n\n        console.log("tonemap for WebGL2")\n\n        return engineState\n    })\n}\n')),(0,i.kt)("h4",{id:"\u8fd0\u884cclient\u7684\u4ee3\u7801-2"},"\u8fd0\u884cClient\u7684\u4ee3\u7801"),(0,i.kt)("p",null,"\u4e0b\u9762\uff0c\u6211\u4eec\u8fd0\u884cClient\u7684\u4ee3\u7801\uff0c\u6253\u5370\u7684\u7ed3\u679c\u5982\u4e0b\uff1a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"is PC\n\u521d\u59cb\u5316WebGL2\n\u5ef6\u8fdf\u6e32\u67d3\ntonemap for WebGL2\n")),(0,i.kt)("p",null,"\u6253\u5370\u7ed3\u679c\u8ddf\u4e4b\u524d\u4e00\u6837"),(0,i.kt)("h2",{id:"\u5b9a\u4e49"},"\u5b9a\u4e49"),(0,i.kt)("h3",{id:"\u4e00\u53e5\u8bdd\u5b9a\u4e49"},"\u4e00\u53e5\u8bdd\u5b9a\u4e49"),(0,i.kt)("p",null,"\u5c06\u8fde\u7eed\u7684\u3001\u6709\u4e00\u5b9a\u6267\u884c\u987a\u5e8f\u7684\u903b\u8f91\u79bb\u6563\u5316\u4e3a\u4e00\u4e2a\u4e2a\u72ec\u7acb\u7684Job\uff0c\u6309\u7167\u914d\u7f6e\u6570\u636e\u5b9a\u4e49\u7684\u987a\u5e8f\u5728\u7ba1\u9053\u4e2d\u4f9d\u6b21\u6267\u884c"),(0,i.kt)("h3",{id:"\u8865\u5145\u8bf4\u660e"},"\u8865\u5145\u8bf4\u660e"),(0,i.kt)("p",null,"\u56e0\u4e3a\u8003\u8651\u5230Job\u53ef\u80fd\u4f1a\u8fdb\u884c\u5f02\u6b65\u64cd\u4f5c\uff0c\u5e76\u4e14\u4e5f\u53ef\u80fd\u4f1a\u5e76\u884c\u5730\u6267\u884c\u591a\u4e2aJob\uff08\u5f53\u914d\u7f6e\u6570\u636e\u4e2d\u7684link\u5b57\u6bb5\u4e3amerge\u65f6\uff09\uff0c\u6240\u4ee5\u57fa\u4e8eFRP\uff08\u51fd\u6570\u53cd\u5e94\u578b\u7f16\u7a0b\uff09\uff0c\u4f7f\u7528\u6d41\u6765\u5904\u7406\u5f02\u6b65\u64cd\u4f5c\u3002\u5177\u4f53\u5c31\u662f\u8ba9\u6bcf\u4e2aJob\u8fd4\u56de\u4e00\u4e2a\u6d41\uff0c\u5e76\u4e14\u6574\u4e2a\u7ba1\u9053\u5c31\u662f\u4e00\u4e2a\u6d41"),(0,i.kt)("h3",{id:"\u901a\u7528uml"},"\u901a\u7528UML"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u9886\u57df\u6a21\u578b")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"\u9886\u57df\u6a21\u578b\u56fe",src:t(3027).Z})),(0,i.kt)("p",null,"\u603b\u4f53\u6765\u770b\uff0c\u9886\u57df\u6a21\u578b\u5206\u4e3a\u7528\u6237\u3001System\u3001\u7ba1\u9053\u7ba1\u7406\u3001\u7ba1\u9053\u6a21\u5757\u56db\u4e2a\u90e8\u5206"),(0,i.kt)("p",null,"\u6211\u4eec\u770b\u4e0b\u7528\u6237\u8fd9\u4e2a\u90e8\u5206\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Client",(0,i.kt)("br",{parentName:"li"}),"\u8be5\u89d2\u8272\u662f\u7528\u6237")),(0,i.kt)("p",null,"\u6211\u4eec\u770b\u4e0bSystem\u8fd9\u4e2a\u90e8\u5206\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"System",(0,i.kt)("br",{parentName:"li"}),"\u8be5\u89d2\u8272\u662f\u95e8\u6237\uff0c\u4e0b\u9762\u4ecb\u7ecd\u5b83\u7684\u51fd\u6570\uff1a",(0,i.kt)("br",{parentName:"li"}),"System\u7684createState\u51fd\u6570\u521b\u5efa\u4e86SystemState\uff1bSystem\u7684registerAllPipelines\u51fd\u6570\u6309\u7167\u4e0d\u540c\u7684\u8fd0\u884c\u73af\u5883\u6ce8\u518c\u4e86\u5bf9\u5e94\u7684\u7ba1\u9053\u6a21\u5757\uff1bSystem\u7684init\u51fd\u6570\u8fd0\u884c\u4e86\u6ce8\u518c\u7684\u7ba1\u9053\u6a21\u5757\u7684Init Pipeline\u7ba1\u9053\uff0c\u4f9d\u6b21\u6267\u884c\u5b83\u6240\u6709\u7684Job\uff0c\u5b9e\u73b0\u4e86\u521d\u59cb\u5316\uff1bSystem\u53ef\u80fd\u6709\u591a\u4e2arunPipelineX\u51fd\u6570\uff0c\u5176\u4e2d\u6bcf\u4e2a\u51fd\u6570\u7528\u6765\u8fd0\u884c\u6ce8\u518c\u7684\u7ba1\u9053\u6a21\u5757\u7684\u5bf9\u5e94\u7ba1\u9053\uff0c\u5b9e\u73b0\u67d0\u4e2a\u8fd0\u884c\u65f6\u903b\u8f91\uff08\u5982\u6e32\u67d3\uff09")),(0,i.kt)("p",null,"\u6211\u4eec\u770b\u4e0b\u7ba1\u9053\u7ba1\u7406\u8fd9\u4e2a\u90e8\u5206\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"PipelineManager",(0,i.kt)("br",{parentName:"li"}),"\u8be5\u89d2\u8272\u8d1f\u8d23\u7ba1\u7406\u7ba1\u9053\uff0c\u5b9e\u73b0\u4e86\u6ce8\u518c\u7ba1\u9053\u3001\u5408\u5e76\u7ba1\u9053\u3001\u8fd0\u884c\u7ba1\u9053\u7684\u5b9e\u73b0\u903b\u8f91")),(0,i.kt)("p",null,"\u6211\u4eec\u770b\u4e0b\u7ba1\u9053\u6a21\u5757\u8fd9\u4e2a\u90e8\u5206\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Pipeline",(0,i.kt)("br",{parentName:"p"}),"\n","\u8be5\u89d2\u8272\u662f\u6ce8\u518c\u7684\u7ba1\u9053\u6a21\u5757")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"PipelineState",(0,i.kt)("br",{parentName:"p"}),"\n","\u8be5\u89d2\u8272\u4fdd\u5b58\u4e86\u7ba1\u9053\u6a21\u5757\u4e2d\u6240\u6709\u7ba1\u9053\u7684\u6570\u636e")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"PipelineStateType",(0,i.kt)("br",{parentName:"p"}),"\n","\u8be5\u89d2\u8272\u662fPipelineState\u7684\u7c7b\u578b\u5b9a\u4e49")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"X Pipeline",(0,i.kt)("br",{parentName:"p"}),"\n","\u8be5\u89d2\u8272\u662f\u4e00\u4e2a\u7ba1\u9053")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Job",(0,i.kt)("br",{parentName:"p"}),"\n","\u8be5\u89d2\u8272\u662f\u4e00\u6bb5\u72ec\u7acb\u7684\u903b\u8f91"))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u89d2\u8272\u4e4b\u95f4\u7684\u5173\u7cfb")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"System\u53ef\u4ee5\u6ce8\u518c\u591a\u4e2aPipeline\uff0c\u5b83\u4eec\u4e2d\u540c\u540d\u7684\u7ba1\u9053\u4f1a\u5408\u5e76")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u4e00\u4e2aPipeline\u6709\u4e00\u4e2aPipelineState\u548c\u591a\u4e2aX Pipeline")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u4e00\u4e2aPipelineState\u5b9e\u73b0\u4e86\u5bf9\u5e94\u7684PipelineStateType")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u4e00\u4e2aX Pipeline\u6709\u591a\u4e2aJob"))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6bcf\u4e2aJob\u90fd\u80fd\u8bfb\u5199\u6240\u6709\u7684PipelineState\uff0c\u4f46\u5b83\u4eec\u6ca1\u6709\u76f4\u63a5\u4f9d\u8d56PipelineState\uff0c\u800c\u662f\u4f9d\u8d56\u5b83\u5b9e\u73b0\u7684PipelineStateType")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5982\u679c\u4e00\u4e2aPipeline A\u4e2d\u7684Job\u4f9d\u8d56\u4e86\u53e6\u4e00\u4e2aPipeline B\u7684PipelineState\uff0c\u90a3\u4e48Pipeline A\u7684PipelineStateType\u5c31\u9700\u8981\u5728states\u5b57\u6bb5\u5305\u62ecPipeline B\u7684PipelineStateType\u7684state\uff0c\u8fd9\u5728\u9886\u57df\u6a21\u578b\u4e2d\u8868\u73b0\u4e3aPipelineStateType\u5bf9\u81ea\u5df1\u7684\u4f9d\u8d56"))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6570\u636e\u89c6\u56fe")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"\u6570\u636e\u89c6\u56fe",src:t(2081).Z})),(0,i.kt)("p",null,"\u603b\u4f53\u6765\u770b\uff0c\u6570\u636e\u5206\u4e3a\u8fd0\u884c\u65f6\u6570\u636e\u548c\u914d\u7f6e\u6570\u636e\uff0c\u5176\u4e2d\u5404\u4e2aState\u662f\u8fd0\u884c\u65f6\u6570\u636e\uff0c\u5404\u4e2aJSON\u662f\u914d\u7f6e\u6570\u636e"),(0,i.kt)("p",null,"System\u6709\u81ea\u5df1\u7684\u6570\u636e-SystemState\uff0c\u5b83\u5305\u62ec\u4e86\u6240\u6709\u5176\u5b83\u7684state"),(0,i.kt)("p",null,"PipelineManager\u6709\u81ea\u5df1\u7684\u6570\u636e-PipeStateManagerState\uff0c\u5b83\u5305\u62ec\u4e86\u6240\u6709\u7ba1\u9053\u6a21\u5757\u7684PipelineState"),(0,i.kt)("p",null,"Pipeline\u6709\u4e00\u4e2aPipelineState\u6570\u636e\u548c\u4e00\u4e2aJSON\u914d\u7f6e\u6570\u636e\uff0c\u5176\u4e2dPipelineState\u4fdd\u5b58\u4e86\u7ba1\u9053\u6a21\u5757\u4e2d\u6240\u6709\u7ba1\u9053\u7684\u8fd0\u884c\u65f6\u6570\u636e\uff0cJSON\u914d\u7f6e\u6570\u636e\u7528\u6765\u6307\u5b9a\u7ba1\u9053\u6a21\u5757\u4e2d\u6240\u6709\u7ba1\u9053\u7684Job\u7684\u6267\u884c\u987a\u5e8f"),(0,i.kt)("h3",{id:"\u89d2\u8272\u7684\u62bd\u8c61\u4ee3\u7801"},"\u89d2\u8272\u7684\u62bd\u8c61\u4ee3\u7801"),(0,i.kt)("p",null,"\u4e0b\u9762\u6211\u4eec\u6765\u770b\u770b\u5404\u4e2a\u89d2\u8272\u7684\u62bd\u8c61\u4ee3\u7801\uff1a"),(0,i.kt)("p",null,"\u6211\u4eec\u4f9d\u6b21\u770b\u4e0b\u9886\u57df\u6a21\u578b\u4e2d\u7528\u6237\u3001System\u3001\u7ba1\u9053\u6a21\u5757\u8fd9\u51e0\u4e2a\u90e8\u5206\u7684\u62bd\u8c61\u4ee3\u7801\uff1a"),(0,i.kt)("p",null,"\u9996\u5148\uff0c\u6211\u4eec\u770b\u4e0bClient\u7684\u62bd\u8c61\u4ee3\u7801",(0,i.kt)("br",{parentName:"p"}),"\n","\u7136\u540e\uff0c\u6211\u4eec\u770b\u4e0bSystem\u7684\u62bd\u8c61\u4ee3\u7801",(0,i.kt)("br",{parentName:"p"}),"\n","\u6700\u540e\uff0c\u6211\u4eec\u770b\u4e0b\u7ba1\u9053\u6a21\u5757\u8fd9\u4e2a\u90e8\u5206\u7684\u62bd\u8c61\u4ee3\u7801\uff0c\u5b83\u4eec\u5305\u62ec\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"PipelineStateType\u7684\u62bd\u8c61\u4ee3\u7801"),(0,i.kt)("li",{parentName:"ul"},"Pipeline\u7684\u62bd\u8c61\u4ee3\u7801"),(0,i.kt)("li",{parentName:"ul"},"Job\u7684\u62bd\u8c61\u4ee3\u7801")),(0,i.kt)("h4",{id:"client\u7684\u62bd\u8c61\u4ee3\u7801"},"Client\u7684\u62bd\u8c61\u4ee3\u7801"),(0,i.kt)("p",null,"Client"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"let systemState = System.createState()\n\nsystemState = System.registerAllPipelines(systemState)\n\nSystem.init(systemState, configForInit).then(systemState => {\n    System.runPipeline1(systemState, pipeline1Config).then(systemState => {\n        \u8fd0\u884c\u66f4\u591a\u7684\u7ba1\u9053...\n    })\n})\n")),(0,i.kt)("h4",{id:"system\u7684\u62bd\u8c61\u4ee3\u7801"},"System\u7684\u62bd\u8c61\u4ee3\u7801"),(0,i.kt)("p",null,"SystemStateType"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export type state = {\n    pipelineManagerState: pipelineManagerState\n}\n")),(0,i.kt)("p",null,"System"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'declare function _isEnvironment1(): boolean\n\nexport let createState = (): state => {\n    return {\n        pipelineManagerState: PipelineManager.createState()\n    }\n}\n\nexport let registerAllPipelines = (state: state) => {\n    if (_isEnvironment1()) {\n        let pipelineManagerState = PipelineManager.registerPipeline(\n            state.pipelineManagerState,\n            Pipeline1.getPipeline(),\n            []\n        )\n\n        pipelineManagerState = PipelineManager.registerPipeline(\n            pipelineManagerState,\n            Pipeline2.getPipeline(),\n            if (\u9700\u8981\u5408\u5e76Pipeline2\u548cPipeline1\u7684\u67d0\u4e2aX Pipeline\u7ba1\u9053) {\n                [\n                    {\n                        pipelineName: \u67d0\u4e2aX Pipeline\u540d,\n                        insertElementName: \u63d2\u5165\u5230\u7684Element\u540d,\n                        insertAction: "before" or "after" \n                    },\n                    \u6307\u5b9a\u5176\u5b83\u7684X Pipeline\u7684\u5408\u5e76...\n                ]\n            }\n            else{\n                []\n            }\n        )\n\n        \u6ce8\u518c\u66f4\u591a\u7684Pipeline...\n\n        state = {\n            ...state,\n            pipelineManagerState: pipelineManagerState\n        }\n    }\n    else {\n        \u6ce8\u518c\u5176\u5b83Environment\u7684Pipeline...\n    }\n\n    return state\n}\n\n...\n\nexport let init = (state: state, initConfig) => {\n    \u521d\u59cb\u5316\u7ba1\u9053\n\n    //\u628a\u914d\u7f6e\u4fdd\u5b58\u5230\u5168\u5c40\u53d8\u91cf\u4e2d\uff0c\u4ece\u800c\u5728Job\u4e2d\u901a\u8fc7\u5168\u5c40\u53d8\u91cf\u83b7\u5f97\u914d\u7f6e\n    globalThis.initConfig = initConfig\n\n    \u8fd0\u884cInit Pipeline\u7ba1\u9053\n}\n\nexport let runPipeline1 = (state: state, pipeline1Config) => {\n    //\u628a\u914d\u7f6e\u4fdd\u5b58\u5230\u5168\u5c40\u53d8\u91cf\u4e2d\uff0c\u4ece\u800c\u5728Job\u4e2d\u901a\u8fc7\u5168\u5c40\u53d8\u91cf\u83b7\u5f97\u914d\u7f6e\n    globalThis.pipeline1Config = pipeline1Config\n\n    //\u8fd0\u884c\u67d0\u4e2aX Pipeline\n    return _runPipeline(state, \u67d0\u4e2aX Pipeline\u540d)\n}\n\n\u66f4\u591a\u7684runPipelineX\u51fd\u6570\uff0c\u8fd0\u884c\u5bf9\u5e94\u7684X Pipeline...\n')),(0,i.kt)("p",null,"runPipeline1\u51fd\u6570\u5728\u5b9e\u9645\u9879\u76ee\u4e2d\uff0c\u5b83\u7684\u540d\u5b57\u53ef\u80fd\u662fupdate\u6216\u8005render\u7b49\u540d\u5b57\uff0c\u5b83\u901a\u8fc7\u8fd0\u884cUpdate Pipeline\u6216\u8005Render Pipeline\u7b49\u67d0\u4e2aX Pipeline\u6765\u5b9e\u73b0\u66f4\u65b0\u6216\u8005\u6e32\u67d3\u7b49\u903b\u8f91"),(0,i.kt)("h4",{id:"pipelinestatetype\u7684\u62bd\u8c61\u4ee3\u7801"},"PipelineStateType\u7684\u62bd\u8c61\u4ee3\u7801"),(0,i.kt)("p",null,"Pipeline1StateType"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export const pipelineName = X Pipeline\u540d\n\n// PipelineState\u7684\u7c7b\u578b\nexport type state = {\n    ...\n}\n\n//\u8be5Pipeline\u7684Job\u4f7f\u7528\u7684\u6240\u6709PipelineState\u7684\u7c7b\u578b\nexport type states = {\n    [pipelineName]: state,\n\n    [\u4f9d\u8d56\u7684\u5176\u5b83PipelineState\u7684\u540d\u79f0]: \u4f9d\u8d56\u7684\u5176\u5b83PipelineState\u7684state\u7c7b\u578b,\n}\n")),(0,i.kt)("p",null,"\u6709\u591a\u4e2aPipelineStateType\uff0c\u8fd9\u91cc\u53ea\u7ed9\u51fa\u4e00\u4e2aPipelineStateType\u7684\u62bd\u8c61\u4ee3\u7801"),(0,i.kt)("h4",{id:"pipeline\u7684\u62bd\u8c61\u4ee3\u7801"},"Pipeline\u7684\u62bd\u8c61\u4ee3\u7801"),(0,i.kt)("p",null,"Pipeline1"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'let _getExec = (pipelineName: string, jobName: string) => {\n    switch (jobName) {\n        case Job1\u7684JSON\u540d\n            return Job1.exec\n        case \u66f4\u591aJob\u7684JSON\u540d...\n            return ...\n        default:\n            return null\n    }\n}\n\nexport let getPipeline = (): ... => {\n    return {\n        pipelineName: pipelineName,\n        createState: systemState => {\n            return \u521b\u5efaPipelineState...\n        },\n        getExec: _getExec,\n        allPipelineData: [\n            {\n                name: \u67d0\u4e2aX Pipeline\u540d,\n                groups: [\n                    {\n                        name: "first_xxx",\n                        link: "concat" or "merge"\n                        elements: [\n                            \u5305\u542b\u7684group\u6216\u8005job\u7684\u914d\u7f6e\u6570\u636e\uff08\u5c06\u4f1a\u4f9d\u6b21\u6309\u7167link\u7684\u65b9\u5f0f\u6267\u884c\u6bcf\u4e2aelement\uff09\n                        ]\n                    },\n                    \u66f4\u591a\u7684group...\n                ],\n                first_group: "first_xxx"\n            },\n\n            \u66f4\u591aX Pipeline\u7684\u914d\u7f6e\u6570\u636e...\n        ],\n    }\n}\n')),(0,i.kt)("p",null,"\u6709\u591a\u4e2aPipeline\uff0c\u8fd9\u91cc\u53ea\u7ed9\u51fa\u4e00\u4e2aPipeline\u7684\u62bd\u8c61\u4ee3\u7801"),(0,i.kt)("h4",{id:"job\u7684\u62bd\u8c61\u4ee3\u7801"},"Job\u7684\u62bd\u8c61\u4ee3\u7801"),(0,i.kt)("p",null,"Job1"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export let exec: ... = (systemState, { getStatesFunc, setStatesFunc }) => {\n    let states = getStatesFunc<states>(systemState)\n\n    //\u901a\u8fc7\u5168\u5c40\u53d8\u91cf\u83b7\u5f97\u914d\u7f6e\n    let initConfig = globalThis.initConfig\n    let pipeline1Config = globalThis.pipeline1Config\n\n    return mostService.callFunc(() => {\n        let xxx = Utils.\u83b7\u5f97\u4f9d\u8d56\u7684\u5176\u5b83PipelineState\u7684\u6570\u636e(states)\n        //\u83b7\u5f97\u81ea\u5df1\u7684PipelineState\n        let pipelineState = Utils.getState(states)\n\n        if (\u9700\u8981\u5199\u6570\u636e\u5230\u81ea\u5df1\u7684PipelineState) {\n            return setStatesFunc<systemState, states>(\n                systemState,\n                Utils.setState(states, {\n                    ...Utils.getState(states),\n                    \u5199\u6570\u636e\n                })\n            )\n        }\n        else if (\u9700\u8981\u5199\u6570\u636e\u5230\u5176\u5b83\u7684PipelineState) {\n            return setStatesFunc<systemState, states>(\n                systemState,\n                Utils.\u8bbe\u7f6e\u4f9d\u8d56\u7684\u5176\u5b83PipelineState(states, {\n                    ...Utils.\u83b7\u5f97\u4f9d\u8d56\u7684\u5176\u5b83PipelineState(states),\n                    \u5199\u6570\u636e\n                })\n            )\n        }\n        else {\n            return systemState\n        }\n    })\n}\n")),(0,i.kt)("p",null,"Utils"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export function getState(states: states): state {\n    return states[Pipeline1StateType.pipelineName]\n}\n\nexport function setState(states: states, state: state): states {\n    return Object.assign({}, states, {\n        [Pipeline1StateType.pipelineName]: state\n    })\n}\n\nexport function \u83b7\u5f97\u4f9d\u8d56\u7684\u5176\u5b83PipelineState(states: states): \u5176\u5b83PipelineStateType.state {\n    return states[\u4f9d\u8d56\u7684\u5176\u5b83PipelineStateType.pipelineName]\n}\n\nexport function \u8bbe\u7f6e\u4f9d\u8d56\u7684\u5176\u5b83PipelineState(states: states, state: \u5176\u5b83PipelineStateType.state): states {\n    return Object.assign({}, states, {\n        [\u4f9d\u8d56\u7684\u5176\u5b83PipelineStateType.pipelineName]: state\n    })\n}\n\nexport function \u83b7\u5f97\u4f9d\u8d56\u7684\u5176\u5b83PipelineState\u7684\u6570\u636e(states: states) {\n    return \u83b7\u5f97\u4f9d\u8d56\u7684\u5176\u5b83PipelineState(states).xxx\n}\n")),(0,i.kt)("p",null,"\u6709\u591a\u4e2aJob\uff0c\u8fd9\u91cc\u53ea\u7ed9\u51fa\u4e00\u4e2aJob\u7684\u62bd\u8c61\u4ee3\u7801"),(0,i.kt)("p",null,"\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","Job\u4e00\u822c\u90fd\u53ea\u5199\u6570\u636e\u5230\u81ea\u5df1\u7684PipelineState\uff0c\u6700\u597d\u4e0d\u8981\u4fee\u6539\u5176\u5b83\u7684PipelineState\uff0c\u4ee5\u514d\u9020\u6210\u51b2\u7a81"),(0,i.kt)("h3",{id:"\u9075\u5faa\u7684\u8bbe\u8ba1\u539f\u5219\u5728uml\u4e2d\u7684\u4f53\u73b0"},"\u9075\u5faa\u7684\u8bbe\u8ba1\u539f\u5219\u5728UML\u4e2d\u7684\u4f53\u73b0"),(0,i.kt)("p",null,"\u7ba1\u9053\u6a21\u5f0f\u4e3b\u8981\u9075\u5faa\u4e0b\u9762\u7684\u8bbe\u8ba1\u539f\u5219\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5355\u4e00\u804c\u8d23\u539f\u5219",(0,i.kt)("br",{parentName:"li"}),"\u6bcf\u4e2aJob\u53ea\u505a\u4e00\u4ef6\u4e8b\u60c5\uff1b\u6bcf\u4e2a\u7ba1\u9053\u53ea\u505a\u4e00\u4ef6\u4e8b\u60c5\uff0c\u5982\u521d\u59cb\u5316\u6216\u8005\u6e32\u67d3"),(0,i.kt)("li",{parentName:"ul"},"\u5408\u6210\u590d\u7528\u539f\u5219",(0,i.kt)("br",{parentName:"li"}),"Pipeline\u7ec4\u5408\u4e86\u591a\u4e2aX Pipeline\uff1bX Pipeline\u7ec4\u5408\u4e86\u591a\u4e2aJob"),(0,i.kt)("li",{parentName:"ul"},"\u4f9d\u8d56\u5012\u7f6e\u539f\u5219",(0,i.kt)("br",{parentName:"li"}),"Job\u6ca1\u6709\u76f4\u63a5\u4f9d\u8d56PipelineState\uff0c\u800c\u662f\u4f9d\u8d56\u62bd\u8c61\u7684PipelineStateType"),(0,i.kt)("li",{parentName:"ul"},"\u63a5\u53e3\u9694\u79bb\u539f\u5219",(0,i.kt)("br",{parentName:"li"}),"PipelineStateType\u7684states\u5b57\u6bb5\u4e2d\u53ea\u5b9a\u4e49\u9700\u8981\u4f7f\u7528\u7684PipelineState\u7684state\u7c7b\u578b\uff0c\u4fdd\u6301\u6700\u5c0f"),(0,i.kt)("li",{parentName:"ul"},"\u6700\u5c11\u77e5\u8bc6\u539f\u5219",(0,i.kt)("br",{parentName:"li"}),"\u5404\u4e2aJob\u76f8\u4e92\u72ec\u7acb\uff1b\u5404\u4e2a\u7ba1\u9053\u76f8\u4e92\u72ec\u7acb"),(0,i.kt)("li",{parentName:"ul"},"\u5f00\u95ed\u539f\u5219",(0,i.kt)("br",{parentName:"li"}),"\u8981\u8c03\u6574\u7ba1\u9053\u7684Job\u6267\u884c\u987a\u5e8f\uff0c\u53ea\u9700\u8981\u8c03\u6574\u914d\u7f6e\u6570\u636e\uff0c\u65e0\u9700\u4fee\u6539\u4ee3\u7801\uff1b\u8981\u589e\u52a0\u4e00\u79cd\u8fd0\u884c\u73af\u5883\uff0c\u53ea\u9700\u8981\u589e\u52a0\u4e00\u4e2a\u7ba1\u9053\u6a21\u5757\uff0c\u65e0\u9700\u4fee\u6539\u5176\u5b83\u7ba1\u9053\u6a21\u5757")),(0,i.kt)("h2",{id:"\u5e94\u7528"},"\u5e94\u7528"),(0,i.kt)("h3",{id:"\u4f18\u70b9"},"\u4f18\u70b9"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u4e0d\u61c2\u4ee3\u7801\u7684\u540c\u5b66\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u914d\u7f6e\u6570\u636e\u6765\u5b9a\u5236\u7ba1\u9053")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u591a\u4e2a\u5f00\u53d1\u8005\u80fd\u591f\u540c\u65f6\u5f00\u53d1\u4e0d\u540c\u7684\u7ba1\u9053\uff0c\u6216\u8005\u540c\u65f6\u5f00\u53d1\u540c\u4e00\u4e2a\u7ba1\u9053\u4e2d\u4e0d\u540c\u7684Job\u3002\u56e0\u4e3a\u5b83\u4eec\u4e4b\u95f4\u76f8\u4e92\u72ec\u7acb\uff0c\u6240\u4ee5\u591a\u4eba\u5f00\u53d1\u65f6\u4e0d\u4f1a\u76f8\u4e92\u5f71\u54cd")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Job\u7684exec\u51fd\u6570\u3001Pipeline\u7684getPipeline\u51fd\u6570\u90fd\u5177\u6709\u7edf\u4e00\u7684\u8f93\u5165\u548c\u8f93\u51fa\u7684\u7c7b\u578b\uff0c\u4ece\u800c\u591a\u4eba\u5f00\u53d1Job\u548cPipeline\u6a21\u5757\u65f6\u4e0d\u4f1a\u51fa\u73b0\u8f93\u5165\u8f93\u51fa\u7684\u51b2\u7a81"))),(0,i.kt)("h3",{id:"\u7f3a\u70b9"},"\u7f3a\u70b9"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u9700\u8981\u8f6c\u6362\u4e3a\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u601d\u7ef4",(0,i.kt)("br",{parentName:"li"}),"Job\u4e2d\u57fa\u4e8eFRP\u4f7f\u7528\u6d41\u6765\u5904\u7406\u5f02\u6b65\u3001\u4e00\u4e2aJob\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u51fd\u6570\u3001\u7ba1\u9053\u4f9d\u6b21\u6267\u884c\u5404\u4e2aJob\u3001\u4f7f\u7528state\u4fdd\u5b58\u6570\u636e\u7b49\u8fd9\u4e9b\u601d\u8def\u90fd\u5c5e\u4e8e\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u601d\u7ef4\u6a21\u5f0f")),(0,i.kt)("h3",{id:"\u4f7f\u7528\u573a\u666f"},"\u4f7f\u7528\u573a\u666f"),(0,i.kt)("h4",{id:"\u573a\u666f\u63cf\u8ff0"},"\u573a\u666f\u63cf\u8ff0"),(0,i.kt)("p",null,"\u9700\u8981\u6309\u4e32\u884c\u6216\u8005\u5e76\u884c\u7684\u987a\u5e8f\u8fde\u7eed\u5730\u6267\u884c\u591a\u4e2a\u903b\u8f91"),(0,i.kt)("h4",{id:"\u5177\u4f53\u6848\u4f8b"},"\u5177\u4f53\u6848\u4f8b"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u7cfb\u7edf\u7684\u521d\u59cb\u5316",(0,i.kt)("br",{parentName:"p"}),"\n","\u521d\u59cb\u5316\u65f6\u901a\u5e38\u9700\u8981\u8fde\u7eed\u5730\u6267\u884c\u4e00\u4e9b\u903b\u8f91\uff0c\u56e0\u6b64\u53ef\u4ee5\u6ce8\u518c\u4e00\u4e2aPipeline\uff0c\u5b83\u5305\u62ec\u4e00\u4e2aInit Pipeline\u7ba1\u9053\uff0c\u8be5\u7ba1\u9053\u5305\u62ec\u521d\u59cb\u5316\u76f8\u5173\u7684Job")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5f15\u64ce\u4e3b\u5faa\u73af\u4e2d\u7684\u66f4\u65b0\u3001\u6e32\u67d3",(0,i.kt)("br",{parentName:"p"}),"\n","\u66f4\u65b0\u3001\u6e32\u67d3\u65f6\u901a\u5e38\u9700\u8981\u8fde\u7eed\u5730\u6267\u884c\u4e00\u4e9b\u903b\u8f91\uff0c\u56e0\u6b64\u53ef\u4ee5\u6ce8\u518c\u4e00\u4e2aPipeline\uff0c\u5b83\u5e94\u8be5\u5305\u62ec\u4e00\u4e2aUpdate Pipeline\u7ba1\u9053\u3001\u4e00\u4e2aRender Pipeline\u7ba1\u9053\uff0c\u524d\u8005\u5305\u62ec\u66f4\u65b0\u76f8\u5173\u7684Job\uff0c\u540e\u8005\u5305\u62ec\u6e32\u67d3\u76f8\u5173\u7684Job\u3002\u5728\u6bcf\u6b21\u4e3b\u5faa\u73af\u65f6\uff0c\u5148\u8fd0\u884cUpdate Pipeline\uff0c\u7136\u540e\u5728\u8fd4\u56de\u7684Promise\u56de\u8c03\u4e2d\u8fd0\u884cRender Pipeline")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u9700\u8981\u8fd0\u884c\u5728\u591a\u4e2a\u8fd0\u884c\u73af\u5883\u4e2d",(0,i.kt)("br",{parentName:"p"}),"\n","\u4e3a\u6bcf\u4e2a\u8fd0\u884c\u73af\u5883\u6ce8\u518c\u4e00\u4e2a\u7ba1\u9053\u6a21\u5757\uff0c\u76f8\u4e92\u4e0d\u5e72\u6270"))),(0,i.kt)("h3",{id:"\u6ce8\u610f\u4e8b\u9879"},"\u6ce8\u610f\u4e8b\u9879"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4e00\u822c\u6765\u8bf4\uff0cJob\u53ef\u4ee5\u8bfb\u6240\u6709\u7684PipelineState\uff0c\u4f46\u6700\u597d\u53ea\u5199\u81ea\u5df1\u6240\u5728\u7ba1\u9053\u6a21\u5757\u7684PipelineState\uff0c\u4ee5\u514d\u51b2\u7a81")),(0,i.kt)("h2",{id:"\u6269\u5c55"},"\u6269\u5c55"),(0,i.kt)("h3",{id:"\u907f\u514d\u4f7f\u7528\u5168\u5c40\u53d8\u91cf\u6765\u4fdd\u5b58\u914d\u7f6e\u6570\u636e\u6539\u4e3a\u5728\u6ce8\u518c\u7ba1\u9053\u65f6\u4f20\u5165\u7ba1\u9053\u7684\u914d\u7f6e\u6570\u636e"},"\u907f\u514d\u4f7f\u7528\u5168\u5c40\u53d8\u91cf\u6765\u4fdd\u5b58\u914d\u7f6e\u6570\u636e\uff0c\u6539\u4e3a\u5728\u6ce8\u518c\u7ba1\u9053\u65f6\u4f20\u5165\u7ba1\u9053\u7684\u914d\u7f6e\u6570\u636e"),(0,i.kt)("p",null,"\u6211\u4eec\u73b0\u5728\u662f\u5728\u8fd0\u884c\u7ba1\u9053\u524d\uff0c\u628a\u914d\u7f6e\u6570\u636e\u4fdd\u5b58\u5230\u5168\u5c40\u53d8\u91cf\uff0c\u4ece\u800c\u5728\u8fd0\u884c\u7ba1\u9053\u65f6\u6267\u884c\u7684Job\u4e2d\uff0c\u901a\u8fc7\u5168\u5c40\u53d8\u91cf\u83b7\u5f97\u914d\u7f6e\u6570\u636e\uff0c\u53c2\u8003\u4ee3\u7801\u5982\u4e0b\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","Pipeline1"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export let runPipeline1 = (state: state, pipeline1Config) => {\n    globalThis.pipeline1Config = pipeline1Config\n\n    \u8fd0\u884c\u67d0\u4e2aX Pipeline\n}\n")),(0,i.kt)("p",null,"Job1"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export let exec: ... = (...) => {\n    ...\n\n    //\u901a\u8fc7\u5168\u5c40\u53d8\u91cf\u83b7\u5f97\u914d\u7f6e\n    let pipeline1Config = globalThis.pipeline1Config\n")),(0,i.kt)("p",null,"\u56e0\u4e3a\u5168\u5c40\u53d8\u91cf\u662f\u5168\u5c40\u5171\u7528\u7684\uff0c\u5bb9\u6613\u76f8\u4e92\u5f71\u54cd\uff0c\u6240\u4ee5\u5e94\u8be5\u5c06\u5176\u6539\u4e3a\u79c1\u6709\u7684\uff0c\u5177\u4f53\u5c31\u662f\u5728\u6ce8\u518c\u7ba1\u9053\u65f6\u4f20\u5165\u7ba1\u9053\u7684\u914d\u7f6e\u6570\u636e\uff0c\u4fdd\u5b58\u5728\u7ba1\u9053\u4e2d\u3002\u4fee\u6539\u540e\u7684\u53c2\u8003\u4ee3\u7801\u5982\u4e0b\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","System"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export let registerAllPipelines = (state, config) => {\n    if (_isEnvironment1()) {\n        let pipeline1Config = config.pipeline1Config\n\n        //\u6ce8\u518cPipeline1\u65f6\u4f20\u5165pipeline1Config\n        let pipelineManagerState = PipelineManager.registerPipeline(\n            ...\n            Pipeline1.getPipeline(),\n            pipeline1Config,\n            ...\n        )\n        ...\n}\n")),(0,i.kt)("p",null,"\u5728Pipeline1\u7684getPipeline\u51fd\u6570\u8fd4\u56de\u7684createState\u51fd\u6570\u4e2d\u5e94\u8be5\u53ef\u4ee5\u63a5\u6536\u5230pipeline1Config\uff1b\u7136\u540e\u5c06\u5176\u4fdd\u5b58\u5230Pipeline1State\u3002\u8fd9\u6837\u5728Job\u4e2d\u53ef\u4ee5\u901a\u8fc7Pipeline1State\u83b7\u5f97pipeline1Config\u3002\u53c2\u8003\u4ee3\u7801\u5982\u4e0b\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","Pipeline1"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export let getPipeline = (): ... => {\n    return {\n        ...\n        createState: (systemState, pipeline1Config) => {\n            return {\n                config: pipeline1Config,\n                ...\n            }\n        },\n")),(0,i.kt)("p",null,"Job1"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export let exec: ... = (...) => {\n    ...\n    let pipeline1State = getState(states)\n\n    let config = pipeline1State.config\n")),(0,i.kt)("h3",{id:"\u53ef\u4ee5\u589e\u5f3a\u7ba1\u9053\u6a21\u5757\u7684json\u914d\u7f6e\u6570\u636e"},"\u53ef\u4ee5\u589e\u5f3a\u7ba1\u9053\u6a21\u5757\u7684JSON\u914d\u7f6e\u6570\u636e"),(0,i.kt)("p",null,"\u76ee\u524d\u53ea\u6709\u6307\u5b9aJob\u6267\u884c\u987a\u5e8f\u7684\u914d\u7f6e\u6570\u636e\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u53ef\u4ee5\u589e\u52a0\u5bf9Job\u8fdb\u884c\u4e00\u4e9b\u914d\u7f6e\u7684\u914d\u7f6e\u6570\u636e\uff0c\u5982\u5728Pipeline\u7684getPipeline\u51fd\u6570\u8fd4\u56de\u7684\u6a21\u5757\u6570\u636e\u4e2d\u589e\u52a0allJobData\u8fd9\u4e2aJSON\u914d\u7f6e\u6570\u636e\uff0c\u5728\u5176\u4e2d\u5bf9Job\u6307\u5b9a\u4e00\u4e9b\u914d\u7f6e\u6570\u636e\u3002  "),(0,i.kt)("p",null,"\u4e3e\u4f8b\u6765\u8bf4\uff0c\u53ef\u4ee5\u5bf9\u8bbe\u7f6eWebGL\u7684clearColor\u7684ClearColorJob\u6307\u5b9aClearColor\u7684\u503c\uff0c\u4ee5\u53ca\u5bf9\u6e05\u7a7aWebGL\u7684ClearJob\u6307\u5b9a\u6e05\u7a7a\u54ea\u4e2aBuffer\u3002\u53c2\u8003\u4ee3\u7801\u5982\u4e0b\uff1a",(0,i.kt)("br",{parentName:"p"}),"\n","Pipeline"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'export let getPipeline = (): ... => {\n    return {\n        ...\n        allJobData: [\n            {\n                //\u5bf9\u5e94ClearColorJob\n                "name": "clear_color",\n                "flags": [\n                    //\u6307\u5b9aclearColor\u503c\n                    "#20B2AA"\n                ]\n            },\n            {\n                //\u5bf9\u5e94ClearJob\n                "name": "clear",\n                //\u6307\u5b9a\u6e05\u7a7a\u8fd9\u4e09\u4e2aBuffer\n                "flags": [\n                    "COLOR_BUFFER",\n                    "DEPTH_BUFFER",\n                    "STENCIL_BUFFER"\n                ]\n            }\n        ]\n')),(0,i.kt)("p",null,"ClearColorJob"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'//exec\u51fd\u6570\u589e\u52a0flags\u5f62\u53c2\uff0c\u4f20\u5165\u914d\u7f6e\u6570\u636e\u4e2d\u7684flags\u7684\u503c\u3002\u8fd9\u91cc\u5b83\u7684\u503c\u662f: \n//["#20B2AA"]\nexport let exec: ... = (systemState, { getStatesFunc, setStatesFunc }, flags) => {\n    ...\n}\n')),(0,i.kt)("p",null,"ClearJob"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'//\u589e\u52a0flags\u5f62\u53c2\uff0c\u4f20\u5165\u914d\u7f6e\u6570\u636e\u4e2d\u7684flags\u7684\u503c\u3002\u8fd9\u91cc\u5b83\u7684\u503c\u662f:\n// [\n//     "COLOR_BUFFER",\n//     "DEPTH_BUFFER",\n//     "STENCIL_BUFFER"\n// ]\nexport let exec: ... = (systemState, { getStatesFunc, setStatesFunc }, flags) => {\n    ...\n}\n')),(0,i.kt)("h2",{id:"\u6700\u4f73\u5b9e\u8df5"},"\u6700\u4f73\u5b9e\u8df5"),(0,i.kt)("h3",{id:"\u54ea\u4e9b\u573a\u666f\u4e0d\u9700\u8981\u4f7f\u7528\u6a21\u5f0f"},"\u54ea\u4e9b\u573a\u666f\u4e0d\u9700\u8981\u4f7f\u7528\u6a21\u5f0f"),(0,i.kt)("p",null,"\u5982\u679c\u903b\u8f91\u4e4b\u95f4\u6ca1\u6709\u660e\u663e\u7684\u6267\u884c\u987a\u5e8f\uff0c\u5219\u4e0d\u9700\u8981\u4f7f\u7528\u7ba1\u9053\u6a21\u5f0f\u5c06\u5176\u7ba1\u9053\u5316"),(0,i.kt)("h3",{id:"\u7ed9\u51fa\u5177\u4f53\u7684\u5b9e\u8df5\u6848\u4f8b"},"\u7ed9\u51fa\u5177\u4f53\u7684\u5b9e\u8df5\u6848\u4f8b"),(0,i.kt)("h4",{id:"\u652f\u6301\u5404\u79cd\u8fd0\u884c\u73af\u5883"},"\u652f\u6301\u5404\u79cd\u8fd0\u884c\u73af\u5883"),(0,i.kt)("p",null,"\u5f15\u64ce\u901a\u5e38\u9700\u8981\u8fd0\u884c\u5728\u5404\u79cd\u8fd0\u884c\u73af\u5883\u4e2d\uff0c\u5982\u8fd0\u884c\u5728\u79fb\u52a8\u7aef\u3001Nodejs\u684c\u9762\u7aef\u3001\u6d4f\u89c8\u5668\u7aef\u7b49\u8fd0\u884c\u73af\u5883\uff0c\u90a3\u4e48\u5f15\u64ce\u5c31\u53ef\u4ee5\u4f7f\u7528\u7ba1\u9053\u6a21\u5f0f\uff0c\u9488\u5bf9\u6bcf\u4e2a\u8fd0\u884c\u73af\u5883\u6ce8\u518c\u4e00\u4e2a\u7ba1\u9053\u6a21\u5757\u3002\u6bcf\u4e2a\u7ba1\u9053\u6a21\u5757\u76f8\u4e92\u72ec\u7acb\u4e92\u4e0d\u5f71\u54cd\uff0c\u53ef\u4ee5\u7531\u4e0d\u540c\u7684\u5f15\u64ce\u5f00\u53d1\u8005\u540c\u65f6\u5f00\u53d1\u4e0d\u540c\u7684\u7ba1\u9053\u6a21\u5757\uff0c\u4ee5\u53ca\u540c\u65f6\u5f00\u53d1\u540c\u4e00\u4e2a\u7ba1\u9053\u7684\u4e0d\u540c\u7684Job"),(0,i.kt)("p",null,"\u5982\u679c\u8981\u5207\u6362\u8fd0\u884c\u73af\u5883\uff0c\u90a3\u4e48\u5c31\u53ea\u662f\u5728System\u7684registerAllPipelines\u51fd\u6570\u4e2d\u6ce8\u518c\u5bf9\u5e94\u7684\u7ba1\u9053\u6a21\u5757\u5373\u53ef"),(0,i.kt)("h4",{id:"\u81ea\u5b9a\u4e49\u7ba1\u9053"},"\u81ea\u5b9a\u4e49\u7ba1\u9053"),(0,i.kt)("p",null,"\u5982\u679c\u5f15\u64ce\u7684\u7528\u6237\u5e0c\u671b\u5f00\u53d1\u81ea\u5b9a\u4e49\u7684\u7ba1\u9053\uff0c\u800c\u4e0d\u662f\u53ea\u80fd\u4f7f\u7528\u5f15\u64ce\u63d0\u4f9b\u7684\u7ba1\u9053\uff0c\u90a3\u4e48\u7528\u6237\u53ef\u4ee5\u5f00\u53d1\u81ea\u5df1\u7684Pipeline\u3001X Pipeline\u548c\u5bf9\u5e94\u7684Job\uff1b\u7136\u540e\u5728Client\u8c03\u7528\u4e86System\u7684registerAllPipelines\u51fd\u6570\u540e\uff0c\u8c03\u7528PipelineManager\u7684registerPipeline\u51fd\u6570\u6765\u6ce8\u518cPipeline\uff0c\u5e76\u5728\u6ce8\u518c\u7684\u65f6\u901a\u8fc7\u6307\u5b9aregisterPipeline\u51fd\u6570\u7684JobOrders\u53c2\u6570\u6765\u5c06\u5176\u5408\u5e76\u5230\u4e0e\u5f15\u64ce\u6ce8\u518c\u7684\u540c\u540d\u7ba1\u9053\u4e2d"),(0,i.kt)("h2",{id:"\u66f4\u591a\u8d44\u6599\u63a8\u8350"},"\u66f4\u591a\u8d44\u6599\u63a8\u8350"),(0,i.kt)("p",null,"most.js\u662f\u4e00\u4e2a\u5f00\u6e90\u7684FRP\u5e93\uff0c\u53ef\u4ee5\u5728\u7f51\u4e0a\u641c\u7d22\u201ccujojs/most\u201d\u6765\u627e\u5230\u5b83\u7684Github Repo"),(0,i.kt)("p",null,"stingray\u6e38\u620f\u5f15\u64ce\uff08\u524d\u8eab\u662fbitsquid\uff09\u4f7f\u7528\u4e86\u7ba1\u9053\u6a21\u5f0f"),(0,i.kt)("p",null,"Frostbite\u7684FrameGraph\u548cUnity\u7684RenderGraph\u53ef\u4ee5\u770b\u6210\u662f\u5bf9\u7ba1\u9053\u6a21\u5f0f\u7684\u6269\u5c55"))}u.isMDXComponent=!0},3027:(e,n,t)=>{t.d(n,{Z:()=>l});const l=t.p+"assets/images/UML-8ea1c206e6121859e9f484bd6119cbbd.png"},2081:(e,n,t)=>{t.d(n,{Z:()=>l});const l=t.p+"assets/images/data_view-0574de9fef71125370b3b87196568bb0.png"},7140:(e,n,t)=>{t.d(n,{Z:()=>l});const l=t.p+"assets/images/UML-63ea9fef9534315d4f82a26e838ec192.png"},9696:(e,n,t)=>{t.d(n,{Z:()=>l});const l=t.p+"assets/images/UML-ac9d5bb45505a60069b212b66d5b3648.png"},3976:(e,n,t)=>{t.d(n,{Z:()=>l});const l=t.p+"assets/images/UML-897a419bb50ced157310d06d33552ea3.png"},2948:(e,n,t)=>{t.d(n,{Z:()=>l});const l=t.p+"assets/images/data_view-224103f95f1ca6fb714a1745cb3a4fdc.png"}}]);