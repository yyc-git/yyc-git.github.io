<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">第2章 依赖隔离模式 | 3D编程模式</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://github.com/yyc-git/3DProgramPattern/3dProgramPattern/docs/依赖隔离模式/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="第2章 依赖隔离模式 | 3D编程模式"><meta data-react-helmet="true" name="description" content="编辑器使用引擎创建场景"><meta data-react-helmet="true" property="og:description" content="编辑器使用引擎创建场景"><link data-react-helmet="true" rel="canonical" href="https://github.com/yyc-git/3DProgramPattern/3dProgramPattern/docs/依赖隔离模式/"><link data-react-helmet="true" rel="alternate" href="https://github.com/yyc-git/3DProgramPattern/3dProgramPattern/docs/依赖隔离模式/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/yyc-git/3DProgramPattern/3dProgramPattern/docs/依赖隔离模式/" hreflang="x-default"><link rel="stylesheet" href="/3dProgramPattern/assets/css/styles.e233dcee.css">
<link rel="preload" href="/3dProgramPattern/assets/js/runtime~main.64bc8973.js" as="script">
<link rel="preload" href="/3dProgramPattern/assets/js/main.c6dc4a90.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/3dProgramPattern/"><b class="navbar__title">3D编程模式</b></a><a class="navbar__item navbar__link navbar__link--active" href="/3dProgramPattern/docs/前言">内容</a><a href="https://github.com/yyc-git/3DProgramPattern" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menuLinkText_OKON">开篇</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/3dProgramPattern/docs/前言">前言</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menuLinkText_OKON">第一部分 第1章 再看设计原则</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/3dProgramPattern/docs/再看设计原则/设计基础/">1.1 设计基础</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/3dProgramPattern/docs/再看设计原则/单一职责原则/">1.2 单一职责原则</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/3dProgramPattern/docs/再看设计原则/合成复用原则/">1.3 合成复用原则</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/3dProgramPattern/docs/再看设计原则/接口隔离原则/">1.4 接口隔离原则</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/3dProgramPattern/docs/再看设计原则/依赖倒置原则/">1.5 依赖倒置原则</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/3dProgramPattern/docs/再看设计原则/最少知识原则/">1.6 最少知识原则</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/3dProgramPattern/docs/再看设计原则/开闭原则/">1.7 开闭原则</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active menuLinkText_OKON">第二部分 7种编程模式</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/3dProgramPattern/docs/依赖隔离模式/">第2章 依赖隔离模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/3dProgramPattern/docs/积木模式/">第3章 积木模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/3dProgramPattern/docs/管道模式/">第4章 管道模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/3dProgramPattern/docs/ECS模式/">第5章 ECS模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/3dProgramPattern/docs/多线程模式/">第6章 多线程模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/3dProgramPattern/docs/撤销重做模式/">第7章 撤销重做模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/3dProgramPattern/docs/拼接模式/">第8章 拼接模式</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>第2章 依赖隔离模式</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="编辑器使用引擎创建场景">编辑器使用引擎创建场景<a class="hash-link" href="#编辑器使用引擎创建场景" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="需求">需求<a class="hash-link" href="#需求" title="Direct link to heading">​</a></h3><p>编辑器需要使用引擎来创建一个场景</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="实现思路">实现思路<a class="hash-link" href="#实现思路" title="Direct link to heading">​</a></h3><p>编辑器引入Three.js引擎，调用它来创建场景</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="给出uml">给出UML<a class="hash-link" href="#给出uml" title="Direct link to heading">​</a></h3><p><strong>领域模型</strong></p><p><img alt="领域模型图" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdcAAAAzCAYAAADFJkLhAAAEoXRFWHRteGZpbGUAJTNDbXhmaWxlJTIwaG9zdCUzRCUyMkVsZWN0cm9uJTIyJTIwbW9kaWZpZWQlM0QlMjIyMDIzLTA1LTE2VDAyJTNBNDAlM0EwMC4xMzlaJTIyJTIwYWdlbnQlM0QlMjI1LjAlMjAoTWFjaW50b3NoJTNCJTIwSW50ZWwlMjBNYWMlMjBPUyUyMFglMjAxMV80XzApJTIwQXBwbGVXZWJLaXQlMkY1MzcuMzYlMjAoS0hUTUwlMkMlMjBsaWtlJTIwR2Vja28pJTIwZHJhdy5pbyUyRjE0LjYuMTMlMjBDaHJvbWUlMkY4OS4wLjQzODkuMTI4JTIwRWxlY3Ryb24lMkYxMi4wLjclMjBTYWZhcmklMkY1MzcuMzYlMjIlMjBldGFnJTNEJTIyWHV0TWpFdTd1anlFOHRTUmRMVG8lMjIlMjB2ZXJzaW9uJTNEJTIyMTQuNi4xMyUyMiUyMHR5cGUlM0QlMjJkZXZpY2UlMjIlM0UlM0NkaWFncmFtJTIwaWQlM0QlMjJPVy1fc0pLOGlqb0c5S3puSFI0diUyMiUyMG5hbWUlM0QlMjIlRTclQUMlQUMlMjAxJTIwJUU5JUExJUI1JTIyJTNFN1ZiQmJwd3dFUDBham9uQVp0bmttTERiVkdvclZVclZwS2ZJZ2drNE1nd3haaGZ5OVRWcmU0SFNycWpVcm5yb0JmemVqTzN4bXhtRFIlMkJPaXZaT3N5ajloQ3NJamZ0cDZkT01SY2gxRyUyQnRrVG5TR2lOVEZFSm5scXFHQWc3dmtiV05LM2JNTlRxQ2VPQ2xFb1hrM0pCTXNTRWpYaG1KUzRuN285bzVqdVdyRU1ac1I5d3NTY2ZlQ3B5ZzE3UmRZRCUyRng1NGxydWRnJTJCamFXQXJtbk8xSjZweWx1QjlSZE92UldDSXFNeXJhR0VTdm5kUEZ6SHYzQyUyQnN4TUFtbFdqTGhjYzF2WXIlMkY2bklUMUc0MGZ5TmVuRDY4WDFNYW1PbmRnU1BYNUxVU3Bjc3l3WkdJN3NMY1NtektGZmxWZm84SG5JMktseVVDVEw2QlVaNVBKR29XYXlsVWhyRlVITEx0SE8lMkY4QXZ2WGdjdVhncGgwYk45MFJ1UUlKSWcxcnhhUWFFODlZT2t5MXZMZHpoYXhvTlRZeWdST3l1RXBqTWdOMXdzJTJGV2NxJTJGWmFBT3IlMkZ4MWdBVHAlMkI3U0JCTU1WMzA1cGl0alN6bzklMkJRUFQyd0NmeU5aTnAxZDB3MGRxZHR5aFhLV1k1SHVWaXMyUTZrZ3Zia0thMlZVRnZ4M1E5NFB6UlE0UG83SHpYUHl2OUx3cENaTUY5eUNYRDVVcDlabXRCZklBMDlwelNyJTJGeGZBejJRSkYxNEF3VDkxQVlTek92ZElKSlJWWnBMbTZMVkJaN2lvRDVyZGFBZEtxbll3NmxIV3YyUEJld1h0V2pvMHM1d3hMbXloNE9yUHRGQjB2c3RGdyUyQkh6ZkxDTiUyRm5IbzlqcyUzRCUzQyUyRmRpYWdyYW0lM0UlM0MlMkZteGZpbGUlM0U5+6YdAAAXC0lEQVR4Xu2dBbAcRRPHJwQNDsHdNbi7QyC4BXeXAMFdPzQEd3eXYIUGDe4a3DVBEiB4vvpNmKNv3vru3d7e666iipebnZnt6e3/dE93TxdjzEijVFUOdKnqxDPMW+U0A9Na5BGV0xZZCJ1G8ziA0I8cOVL1VvNYXsxIXbpYfdWplJbKaTGy08xeVE6byW0dq1U4gNwruLbKaqSchyqtlAzT5qVwQOW0FLbroCVzQMG15AXIM7wqrTzc02ebxQGV02ZxWsdpJQ4ouLbSaqSciyqtlAzT5qVwQOW0FLbroCVzQMG15AXIM7wqrTzc02ebxQGV02ZxWsdpJQ4ouLbSaqSciyqtlAzT5qVwQOW0FLbroCVzQMG15AXIM7wqrTzc02ebxQGV02ZxWsdpJQ4ouLbSaqSciyqtlAzT5qVwQOW0FLbroCVzQMG15AXIM7wqrTzc02ebxQGV02ZxWsdpJQ4ouLbSaqSciyqtlAzT5qVwQOW0FLbroCVzQMG15AXIM7wqrTzc02ebxQGV02ZxWsdpJQ4ouLbSaqSciyqtlAzT5qVwQOW0FLbroCVzoGHg+tdff5lnnnnG3H333ebZZ581X375pfnxxx9N9+7dzTzzzGPmnHNOM/fcc5sNN9zQjDHGGKFs+OGHH8ygQYPs7+OPP75Zbrnlam2/+eYb88ILL9i/J5poIrP00kuXzM7mDq9KKx2/X331VfP555+ne8hrveCCC5qpp546dR8///yzue222+xzE044oVl33XU7jRyrnNaLy8CBA82vv/6aWob8B0YbbTSz2mqrma5du5q77rrLoCsh/m3KKafM3X+7dfDEE0+YYcOG2ddacsklzSSTTNLQV2wIuD711FNm9913N6+99lrs5GeffXZzwQUXmBVXXDGw7UMPPWRWXXVV+9u0005rPvvss1q7G2+80fTu3dv+TT+DBw+OHa+dGqjSSream2yyibn55pvTPeS1vvLKK83WW2+duo+33nrLbio7oxyrnNaLyxRTTGG+/fbb1DIU9MD3339vJp54YjPLLLOYDz/80Da57777zBprrFFI/+3USbN5VDi49u/f3+y3336p1wQwPvfcczs81y7g+ttvv5mePXuav//+2+40b7jhBsNHlodUaaXjXlXB9bLLLjNXXHGFfdl11lnH7L///ulevOTWKqcKriWLoB2+0uB69tlnm7333ruOjzPPPLPZaKONzAILLGBdwb/88ov5+OOPzTXXXGPuv//+urZYsLvsskvdv7ULuA4fPtxMMMEEtXd7//337WLnoQoprb7GmIuMMcPzvG/eqxF9cMXbkZb69etnevXqlfYxk8dyPfTQQ82JJ55ox9x2223N5Zdfnnr8Mh9QOa3nPnL49ddfBy7JTz/9VOfxQ39OM800gW3ZpN9zzz2mW7duTQeOMuUp69iVBdcvvvjCum0loQgA3PHGGy+QHxI4XYOXXnrJcK7lKApcOcN97733bNNxxx3XnuG2KnVycB1hjOlqjOlnjPlfDpDNde+wBNeNN97Y3HTTTU0TlyhwjZNjBdemLVPpcirlhLe+44476s7nwzjRbOBo2ooUOBAxQMQ+QAsvvLB1pzeSCnMLY3FedBHGySg655xzzB577BE7d3Ze0hLYeeedzYUXXpgIXGM7b6EGnRxc+xhjTjLGjIb1aYzpnxFk2xJc48RUwTWOQ4X9XrqcKrgWtpald1QIuPoCsdBCC5nnn3/eEM2WhDhHItoNmnzyyc1XX31VezbKch05cqT5888/7XOMNfroo0cOx7nn22+/bd544w37HGeeiy++uI1gDiPaDR061P6MBe6scKKhee8XX3zRnqFibc8111wd5kC7IUOGGMBVuiEJ+sLlM/bYY9tI5yxUIXcbrzfEGDPpv+/5R0aQbXlwJVAF7ws75Kmmmsoeh+BVibJcw+QYixaZPfbYY835559vWUd0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"></p><p>总体来看，领域模型分为用户、编辑器、引擎这三个部分</p><p>我们看下用户这个部分：</p><p>Client是用户</p><p>我们看下编辑器这个部分：</p><p>Editor是编辑器</p><p>我们看下引擎这个部分：</p><p>Three.js是Three.js引擎</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="给出代码">给出代码<a class="hash-link" href="#给出代码" title="Direct link to heading">​</a></h3><p>我们依次看下每个模块的代码，它们包括：</p><ul><li>Client的代码</li><li>Editor的代码</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="client的代码">Client的代码<a class="hash-link" href="#client的代码" title="Direct link to heading">​</a></h4><p>Client</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">Editor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">createScene</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Client调用Editor来创建场景</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="editor的代码">Editor的代码<a class="hash-link" href="#editor的代码" title="Direct link to heading">​</a></h4><p>Editor</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Scene</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;three&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">createScene</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> scene </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Scene</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Editor引入Three.js引擎，并在createScene函数中调用它来创建场景</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="提出问题">提出问题<a class="hash-link" href="#提出问题" title="Direct link to heading">​</a></h3><ul><li>如果要将Three.js引擎替换为Babylon.js引擎，需要哪些修改？</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="编辑器替换引擎">编辑器替换引擎<a class="hash-link" href="#编辑器替换引擎" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="概述解决方案">概述解决方案<a class="hash-link" href="#概述解决方案" title="Direct link to heading">​</a></h3><ul><li>Editor改为引入Babylon.js引擎，并修改Editor中与引擎相关的代码</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="给出uml-1">给出UML<a class="hash-link" href="#给出uml-1" title="Direct link to heading">​</a></h3><p><strong>领域模型</strong></p><p><img alt="领域模型图" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgkAAAAzCAYAAAAdHJsaAAAEbXRFWHRteGZpbGUAJTNDbXhmaWxlJTIwaG9zdCUzRCUyMkVsZWN0cm9uJTIyJTIwbW9kaWZpZWQlM0QlMjIyMDIzLTA1LTE2VDAyJTNBNDElM0EwOC43NjBaJTIyJTIwYWdlbnQlM0QlMjI1LjAlMjAoTWFjaW50b3NoJTNCJTIwSW50ZWwlMjBNYWMlMjBPUyUyMFglMjAxMV80XzApJTIwQXBwbGVXZWJLaXQlMkY1MzcuMzYlMjAoS0hUTUwlMkMlMjBsaWtlJTIwR2Vja28pJTIwZHJhdy5pbyUyRjE0LjYuMTMlMjBDaHJvbWUlMkY4OS4wLjQzODkuMTI4JTIwRWxlY3Ryb24lMkYxMi4wLjclMjBTYWZhcmklMkY1MzcuMzYlMjIlMjBldGFnJTNEJTIyRUhfbWpJMWhPNkZXOG9DT0dHTDQlMjIlMjB2ZXJzaW9uJTNEJTIyMTQuNi4xMyUyMiUyMHR5cGUlM0QlMjJkZXZpY2UlMjIlM0UlM0NkaWFncmFtJTIwaWQlM0QlMjJNRFhlTk80N2pmT2VzOGd5dXFUaSUyMiUyMG5hbWUlM0QlMjIlRTclQUMlQUMlMjAxJTIwJUU5JUExJUI1JTIyJTNFN1paTmM2TXdESVolMkZEY2QyQUNla3ZlYWozVU43YWFiZDNhTVRxJTJCQ3NRYWtSQ2ZUWHJ5bDJnTkptMGtNemU5aExCajJTa2ZWS052SFlMQzF2TmQ4bTl5aEFlYUV2U28lMkZOdlRDOEhrWG10d1pWQTZKSjJJQllTOUdnb0FWTCUyQlFvVyUyQnBZV1VrRGVDeVJFUlhMYmgydk1NbGhUajNHdGNkOFBlMGJWejdybE1RekFjczNWa1A2VWdwS0dYb1dUbHY4QUdTY3VjeEJkTjU2VXUyQmJTWjV3Z2ZzT1lndVB6VFFpTlU5cE9RTlZhJTJCZDBhZGJkZk9JOWJFeERScWNzbUl1SFZaNDl5dnpsRDFaY3A2dkpFMXpZdCUyQlJVdVlKQm1QcXRpWm9TakRIamF0SFNxY1lpRTFDJTJGMVRkV0czT0h1RFV3TUhBRFJKVnRKaThJRFVvb1ZkWnJOcXlyWDNiOW0lMkZHN05pN0h6cHlYWGVlOE9saHVRSUxJbURs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"></p><p>领域模型跟之前一样，只是将Three.js替换为Babylon.js</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="结合uml图描述如何具体地解决问题">结合UML图，描述如何具体地解决问题<a class="hash-link" href="#结合uml图描述如何具体地解决问题" title="Direct link to heading">​</a></h3><p>需要进行下面的修改：</p><ul><li>将Three.js换成Babylon.js</li><li>修改Editor的相关代码</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="给出代码-1">给出代码<a class="hash-link" href="#给出代码-1" title="Direct link to heading">​</a></h3><p>Client代码跟之前一样，故省略</p><p>我们看下Editor的代码</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="editor的代码-1">Editor的代码<a class="hash-link" href="#editor的代码-1" title="Direct link to heading">​</a></h4><p>Editor</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Scene</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Engine</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;babylonjs&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">createScene</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> scene </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Scene</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Engine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Editor改为引入Babylon.js引擎，并修改createScene函数中与引擎相关的代码，改为调用Babylon.js来创建场景</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="提出问题-1">提出问题<a class="hash-link" href="#提出问题-1" title="Direct link to heading">​</a></h3><ul><li>替换引擎的成本太高<br>替换引擎需要修改Editor中所有与引擎相关代码，成本太高了。有没有办法能在不修改Editor代码的情况下实现替换引擎呢？</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="使用依赖隔离模式来改进">使用依赖隔离模式来改进<a class="hash-link" href="#使用依赖隔离模式来改进" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="概述解决方案-1">概述解决方案<a class="hash-link" href="#概述解决方案-1" title="Direct link to heading">​</a></h3><ul><li>解除依赖<br>只要解除Editor和引擎的依赖，把替换引擎的逻辑隔离出去就可以实现</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="给出uml-2">给出UML<a class="hash-link" href="#给出uml-2" title="Direct link to heading">​</a></h3><p><strong>领域模型</strong></p><p><img alt="领域模型图" src="/3dProgramPattern/assets/images/UML-f7c2f196866bd1fca41b215ba97e10b5.png"></p><p>总体来看，领域模型分为用户、编辑器、引擎、容器这四个部分</p><p>我们看下用户这个部分：</p><p>Client是用户</p><p>我们看下编辑器这个部分：</p><p>Editor是编辑器</p><p>我们看下引擎这个部分：</p><p>Engine接口是对引擎的抽象，抽象出了Editor需要的接口</p><p>BabylonImplement是使用Babylon.js引擎对Engine接口的实现</p><p>ThreeImplement是使用Three.js引擎对Engine接口的实现</p><p>Babylon.js是Babylon.js引擎</p><p>Three.js是Three.js引擎</p><p>我们看下容器这个部分：</p><p>DependencyContainer是保存注入的Engine接口实现的容器，提供操作它的get和set函数</p><p>我们来看下依赖关系：</p><p>Client通过依赖注入的方式注入Engine接口的一个实现（BabylonImplement或者ThreeImplement），从而使Editor能够调用它来创建场景</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="结合uml图描述如何具体地解决问题-1">结合UML图，描述如何具体地解决问题<a class="hash-link" href="#结合uml图描述如何具体地解决问题-1" title="Direct link to heading">​</a></h3><ul><li>替换Three.js为Babylon.js引擎现在不再影响Editor了，只需要增加BabylonImplement，并让Client从注入ThreeImplement改为注入BabylonImplement即可<br>因为Editor只依赖Engine接口，所以Engine接口的实现的变化不会影响Editor</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="给出代码-2">给出代码<a class="hash-link" href="#给出代码-2" title="Direct link to heading">​</a></h3><p>我们依次看下各个部分的代码，它们包括：</p><ul><li>用户的代码</li><li>编辑器的代码</li><li>容器的代码</li><li>引擎的代码</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="用户的代码">用户的代码<a class="hash-link" href="#用户的代码" title="Direct link to heading">​</a></h4><p>Client</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">Editor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">injectDependencies</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BabylonImplement</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">implement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Editor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">createScene</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Client首先注入了BabylonImplement；然后创建了场景</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="编辑器的代码">编辑器的代码<a class="hash-link" href="#编辑器的代码" title="Direct link to heading">​</a></h4><p>Editor</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">injectDependencies</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">implement</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Engine</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DependencyContainer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setEngine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">implement</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">createScene</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> createScene</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Engine </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> DependencyContainer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getEngine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> scene </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createScene</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Editor增加了injectDependencies函数，它将Client注入的Engine接口实现保存到DependencyContainer中 </p><p>createScene函数通过DependencyContainer获得注入的Engine接口实现，它的类型是Engine接口，用来创建场景</p><p>值得注意的是：<br>
<!-- -->Editor只依赖Engine接口，没有依赖Engine接口的实现</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="容器的代码">容器的代码<a class="hash-link" href="#容器的代码" title="Direct link to heading">​</a></h4><p>DependencyContainer</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> _engine</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Engine </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> getEngine </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Engine </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> _engine</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> setEngine </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">engine</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Engine</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _engine </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> engine</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>DependencyContainer使用_engine这个闭包变量来保存注入的Engine接口实现（当然也可以保存到一个state中；或者将DependencyContainer改为一个类，从而保存到它的私有成员中），并提供了get和set函数来获得和保存注入的Engine接口实现</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="引擎的代码">引擎的代码<a class="hash-link" href="#引擎的代码" title="Direct link to heading">​</a></h4><p>Engine</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//scene为抽象类型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//这里用any类型表示抽象类型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name">scene</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">Engine</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">createScene</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> scene</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Engine接口抽象出了Editor需要的接口，其中包括createScene函数</p><p>ThreeImplement</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Scene</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;three&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> implement </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Engine </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function-variable function" style="color:#d73a49">createScene</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Scene</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>ThreeImplement的implement函数使用了Three.js引擎，返回了Engine接口的实现</p><p>BabylonImplement</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Scene</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Engine</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;babylonjs&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> implement </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Engine </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function-variable function" style="color:#d73a49">createScene</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Scene</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Engine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>BabylonImplement的implement函数使用了Babylon.js引擎，返回了Engine接口的实现</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="定义">定义<a class="hash-link" href="#定义" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="一句话定义">一句话定义<a class="hash-link" href="#一句话定义" title="Direct link to heading">​</a></h3><p>隔离系统的外部依赖，使得外部依赖的变化不会影响系统</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="补充说明">补充说明<a class="hash-link" href="#补充说明" title="Direct link to heading">​</a></h3><p>将外部依赖隔离后，系统变得更“纯”了，类似于函数式编程中“纯函数”的概念</p><p>哪些依赖属于外部依赖呢？依赖的各种第三方库、外部环境等都属于外部依赖。具体来说：</p><ul><li>对于编辑器而言，引擎、UI组件库（如Ant Design）、后端、文件操作、日志等都属于外部依赖；</li><li>对于引擎而言，各种子引擎（如物理引擎、动画引擎、粒子引擎）、后端、文件操作、日志等都属于外部依赖</li></ul><p>可以将每个可能会变化的外部依赖都抽象为接口，从而使用依赖隔离模式将其隔离出去</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="通用uml">通用UML<a class="hash-link" href="#通用uml" title="Direct link to heading">​</a></h3><p><strong>领域模型</strong></p><p><img alt="领域模型图" src="/3dProgramPattern/assets/images/UML-49f6f663ae9fed5b0179e7f66d180988.png"></p><p>总体来看，领域模型分为用户、系统、外部依赖、容器这四个部分</p><p>我们看下用户这个部分：</p><ul><li>Client<br>该角色是用户，通过依赖注入的方式注入DependencyImplement</li></ul><p>我们看下系统这个部分：</p><ul><li>System<br>该角色使用了外部依赖，它只知道外部依赖的接口（Dependency）而不知道具体实现（DependencyImplement）</li></ul><p>我们看下外部依赖这个部分：</p><ul><li>Dependency<br>该角色是外部依赖的接口</li><li>DependencyImplement<br>该角色是Dependency的实现</li><li>DependencyLibrary<br>该角色是一个库</li></ul><p>我们看下容器这个部分：</p><ul><li>DependencyContainer<br>该角色是保存注入的DependencyImplement的容器，提供操作它的get和set函数</li></ul><p><strong>角色之间的关系</strong></p><ul><li><p>可以有多个Dependency<br>
<!-- -->如除了Engine以外，还可以有File、Server等Dependency，其中每个Dependency对应一个外部依赖</p></li><li><p>一个Dependency可以有多个DependencyImplement来实现<br>
<!-- -->如Engine的实现除了有ThreeImplement，还可以有BabylonImplement等实现</p></li></ul><ul><li><p>Client可以依赖注入多个Dependency接口的实现。其中，对于一个Dependency接口而言，Client只依赖注入实现它的一个DependencyImplement</p></li><li><p>因为System可以使用多个Dependency接口，所以它们是一对多的关系</p></li><li><p>一个DependencyImplement一般只使用一个DependencyLibrary，但也可以使用多个DependencyLibrary<br>
<!-- -->如可以增加实现Engine接口的ThreeAndBabylonImplement，它同时使用Three.js和Babylon.js这两个DependencyLibrary来创建场景</p></li><li><p>只有一个DependencyContainer容器，它保存了所有注入的DependencyImplement，为每个DependencyImplement都提供了get和set函数</p></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="角色的抽象代码">角色的抽象代码<a class="hash-link" href="#角色的抽象代码" title="Direct link to heading">​</a></h3><p>下面我们来看看各个角色的抽象代码：</p><p>我们依次看下各个部分的抽象代码，它们包括：</p><ul><li>用户的抽象代码</li><li>系统的抽象代码</li><li>容器的抽象代码</li><li>外部依赖的抽象代码</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="用户的抽象代码">用户的抽象代码<a class="hash-link" href="#用户的抽象代码" title="Direct link to heading">​</a></h4><p>Client</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">injectDependencies</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Dependency1Implement1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">implement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> 其它DependencyImplement</span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">doSomethingUseDependency1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="系统的抽象代码">系统的抽象代码<a class="hash-link" href="#系统的抽象代码" title="Direct link to heading">​</a></h4><p>System</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">injectDependencies</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dependency1Implement1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Dependency1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DependencyContainer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setDependency1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dependency1Implement1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    注入其它DependencyImplement</span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">doSomethingUseDependency1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> abstractOperate1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Dependency1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> DependencyContainer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getDependency1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> value1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> abstractType1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">abstractOperate1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">更多doSomethingUseDependencyX函数</span><span class="token operator" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="容器的抽象代码">容器的抽象代码<a class="hash-link" href="#容器的抽象代码" title="Direct link to heading">​</a></h4><p>DependencyContainer</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> _dependency1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Dependency1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">更多的_dependencyX</span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> getDependency1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Dependency1 </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> _dependency1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> setDependency1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dependency1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Dependency1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _dependency1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dependency1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">更多的</span><span class="token keyword" style="color:#00009f">get</span><span class="token plain">和</span><span class="token keyword" style="color:#00009f">set</span><span class="token plain">函数（如getDependency2、setDependency2）</span><span class="token operator" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="外部依赖的抽象代码">外部依赖的抽象代码<a class="hash-link" href="#外部依赖的抽象代码" title="Direct link to heading">​</a></h4><p>Dependency1</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name">abstractType1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">Dependency1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">abstractOperate1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> abstractType1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>有多个Dependency，这里只给出一个Dependency的抽象代码</p><p>Dependency1Implement1</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    api1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;dependencylibrary1&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> implement </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Dependency1 </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function-variable function" style="color:#d73a49">abstractOperate1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            使用api1</span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>DependencyLibrary1</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">api1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>有多个DependencyImplement和多个DependencyLibrary，这里只给出一个DependencyImplement和一个DependencyLibrary的抽象代码</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="遵循的设计原则在uml中的体现">遵循的设计原则在UML中的体现<a class="hash-link" href="#遵循的设计原则在uml中的体现" title="Direct link to heading">​</a></h3><p>依赖隔离模式主要遵循下面的设计原则：</p><ul><li>依赖倒置原则<br>系统依赖于外部依赖的抽象（Dependency）而不是外部依赖的细节（DependencyImplement和DependencyLibrary），从而外部依赖的细节的变化不会影响系统</li><li>开闭原则<br>要隔离更多的外部依赖，只需要增加对应的Dependency、DependencyImplement和DependencyLibrary，以及DependencyContainer增加对应的闭包变量和get、set函数即可，无需修改System；要替换外部依赖的实现，只需要对它的Dependency增加更多的DependencyImplement，然后Client改为注入新的DependencyImplement即可，无需修改System；要修改已有的外部依赖（如升级版本），只需要修改DependencyImplement和DependencyLibrary即可，无需修改System</li></ul><p>依赖隔离模式也应用了“依赖注入”、“控制反转”的思想</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="应用">应用<a class="hash-link" href="#应用" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="优点">优点<a class="hash-link" href="#优点" title="Direct link to heading">​</a></h3><ul><li>提高系统的稳定性<br>外部依赖的变化不会影响系统</li><li>提高系统的扩展性<br>可以任意替换外部依赖而不影响系统</li><li>提高系统的可维护性<br>系统与外部依赖解耦，便于维护</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="缺点">缺点<a class="hash-link" href="#缺点" title="Direct link to heading">​</a></h3><p>无</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="使用场景">使用场景<a class="hash-link" href="#使用场景" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="场景描述">场景描述<a class="hash-link" href="#场景描述" title="Direct link to heading">​</a></h4><p>系统的外部依赖经常变化</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="具体案例">具体案例<a class="hash-link" href="#具体案例" title="Direct link to heading">​</a></h4><ul><li><p>编辑器使用的引擎、UI库等第三方库需要替换</p></li><li><p>编辑器使用的引擎、UI库等第三方库的版本需要升级<br>
<!-- -->如需要升级编辑器使用的Three.js引擎的版本，只需要升级作为DependencyLibrary的Three.js，并修改ThreeImplement，使其使用升级后的Three.js即可</p></li><li><p>需要增加编辑器使用的引擎、UI库等第三方库<br>
<!-- -->如需要让编辑器在已使用Three.js引擎的基础上增加使用Babylon.js引擎，则只需要加入ThreeAndBabylonImplement，让它同时使用Three.js和Babylon.js这两个DependencyLibrary</p></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="注意事项">注意事项<a class="hash-link" href="#注意事项" title="Direct link to heading">​</a></h3><ul><li>Dependency要足够抽象，才不至于在修改或增加DependencyImplement时需要修改Dependency，从而影响System<br>当然，在开发阶段难免考虑不足，如一开始只有一个DependencyImplement时，Dependency往往只会考虑这个DependencyImplement。这导致在增加实现该Dependency的其它DependencyImplement时发现需要修改Dependency，使其更加抽象，这样才能容纳因增加更多的DependencyImplement而带来的变化<br>因此，我们可以允许在开发阶段修改Dependency，但是在发布前则确保Dependency已经足够抽象和稳定</li></ul><ul><li>最好一开始就使用依赖隔离模式，将所有的可能会变化的外部依赖都隔离，这样可以避免后期使用依赖隔离模式时导致系统要改动的地方太多的情况</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="扩展">扩展<a class="hash-link" href="#扩展" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="升级为洋葱架构">升级为洋葱架构<a class="hash-link" href="#升级为洋葱架构" title="Direct link to heading">​</a></h3><p>如果基于依赖隔离模式设计一个这样的架构：</p><ul><li>划分4个层：外部依赖层、应用服务层、领域服务层、领域模型层，其中前者为上层，前者依赖后者</li><li>将系统的所有外部依赖都使用依赖隔离模式来隔离出去，为每个外部依赖抽象一个Dependency接口。将DependencyImplement放到最上层的外部依赖层，将Dependency放到最下层的领域模型层。<br>这是因为DependencyImplement容易变化，所以将其放到最上层，这样它的变化不会影响其它层；而Dependency非常稳定不易变化，且被领域模型依赖，所以将其放到领域模型层</li><li>运用领域驱动设计来设计系统,将系统的核心逻辑建模为领域模型，将其放到领域模型层</li></ul><p>那么这样的架构就是洋葱架构。洋葱架构如下图所示：
<img alt="image" src="/3dProgramPattern/assets/images/onion-8ef11cadf7de72dad5115efc134fb826.webp"></p><p>洋葱架构与传统的三层架构的区别是颠倒了层之间的依赖关系：洋葱架构将三层架构中的最下层（外部依赖层）改为最上层；将三层架构中的倒数第二层（领域模型层）下降为最下层</p><p>洋葱架构的核心思想就是：</p><ul><li>将变化最频繁的外部依赖放在最上层从而不影响其它层</li><li>将领域模型放在最下层，使其不受其它层的影响。虽然它的变化会影响其它层，但是它通常比较稳定，不容易变化</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="最佳实践">最佳实践<a class="hash-link" href="#最佳实践" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="哪些场景不需要使用模式">哪些场景不需要使用模式<a class="hash-link" href="#哪些场景不需要使用模式" title="Direct link to heading">​</a></h3><ul><li>系统的外部依赖比较稳定，不易变化</li></ul><ul><li>开发Demo或者开发短期使用的系统</li></ul><p>对于上面的场景，可以在系统中直接使用外部依赖而不需要使用依赖隔离模式将其隔离，从而能最快地开发系统</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="给出具体的实践案例">给出具体的实践案例<a class="hash-link" href="#给出具体的实践案例" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="扩大使用场景">扩大使用场景<a class="hash-link" href="#扩大使用场景" title="Direct link to heading">​</a></h4><p>编辑器的外部依赖不只是引擎，也包括UI组件库等。如需要将旧的UI组件库（如React UI 组件库-Antd）替换为新的组件库，则可使用依赖隔离模式，提出UI这个Dependency接口，并加入作为UI接口实现的OldUIImplement、NewUIImplement，它们调用对应的UI组件库；然后让Client从注入OldUIImplement改为注入NewUIImplement</p><p>除了编辑器外，引擎、网站等系统也可以使用依赖隔离模式。如需要替换引擎的物理引擎、将网站的后端从阿里云换成腾讯云等场景，都可以使用依赖隔离模式</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="外部依赖在运行时会变化">外部依赖在运行时会变化<a class="hash-link" href="#外部依赖在运行时会变化" title="Direct link to heading">​</a></h4><p>有些外部依赖在运行时会变化，对于这种情况，使用依赖隔离模式后可以在运行时注入变化后的DependencyImplement，从而切换外部依赖。如编辑器向用户提供了“切换渲染效果”的功能，它的需求是：用户点击一个按钮后，切换不同的引擎来渲染场景</p><p>因为引擎的接口是同一个Dependency，所以为了实现该功能，只需在按钮的点击事件中注入实现该Dependency的对应的DependencyImplement到DependencyContainer中即可</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="满足各种修改外部依赖的用户需求">满足各种修改外部依赖的用户需求<a class="hash-link" href="#满足各种修改外部依赖的用户需求" title="Direct link to heading">​</a></h4><p>我遇到过这种问题：3D应用开发完成后，交给3个外部用户使用。用了一段时间后，这3个用户提出了不同的修改外部依赖的要求：第一个用户想要升级3D应用依赖的引擎A，第二个用户想要替换引擎A为引擎B，第三个用户想要同时使用引擎B和升级后的引擎A。<br>
<!-- -->如果3D应用没有使用依赖隔离模式，而是使用调用引擎这个外部依赖的话，我们就需要将交付的代码修改为3个版本，分别满足3个用户的需求。交付的3个版本的代码如下：</p><ul><li>使用了升级A的3D应用代码</li><li>使用了B的3D应用代码</li><li>使用了B和升级A的3D应用代码</li></ul><p>因为每个版本都需要修改3D应用中与引擎相关的代码，所以导致工作量很大。如果使用了依赖隔离模式进行解耦，那么就只需要对3D应用做下面的修改：</p><ul><li>修改AImplement和ALibrary，实现升级</li><li>增加BLibrary</li><li>增加BImplement，它使用BLibrary</li><li>增加ABImplement，它使用BLibrary和升级后的ALibrary</li><li>DependencyContainer增加保存B、AB的闭包变量和对应的get、set函数</li></ul><p>这样的话，交付的代码就只有1个版本，从而减少了很多工作量。只是该版本的代码需要在Client中分别为这3个用户注入不同的DependencyImplement，具体如下：</p><ul><li>Client为第一个用户注入升级后的AImplement</li><li>Client为第二个用户注入BImplement</li><li>Client为第三个用户注入ABImplement</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="更多资料推荐">更多资料推荐<a class="hash-link" href="#更多资料推荐" title="Direct link to heading">​</a></h2><p>可以在网上搜索“依赖注入 控制反转 依赖倒置”来找到依赖注入思想的资料</p><p>可以在网上搜索“洋葱架构”、“the-onion-architecture-part”来找到洋葱架构的资料</p><p>六边形架构类似于洋葱架构，可以在网上搜索“六边形架构”来找到它的资料</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/依赖隔离模式/依赖隔离模式.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/3dProgramPattern/docs/再看设计原则/开闭原则/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">1.7 开闭原则</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/3dProgramPattern/docs/积木模式/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">第3章 积木模式</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#编辑器使用引擎创建场景" class="table-of-contents__link toc-highlight">编辑器使用引擎创建场景</a><ul><li><a href="#需求" class="table-of-contents__link toc-highlight">需求</a></li><li><a href="#实现思路" class="table-of-contents__link toc-highlight">实现思路</a></li><li><a href="#给出uml" class="table-of-contents__link toc-highlight">给出UML</a></li><li><a href="#给出代码" class="table-of-contents__link toc-highlight">给出代码</a></li><li><a href="#提出问题" class="table-of-contents__link toc-highlight">提出问题</a></li></ul></li><li><a href="#编辑器替换引擎" class="table-of-contents__link toc-highlight">编辑器替换引擎</a><ul><li><a href="#概述解决方案" class="table-of-contents__link toc-highlight">概述解决方案</a></li><li><a href="#给出uml-1" class="table-of-contents__link toc-highlight">给出UML</a></li><li><a href="#结合uml图描述如何具体地解决问题" class="table-of-contents__link toc-highlight">结合UML图，描述如何具体地解决问题</a></li><li><a href="#给出代码-1" class="table-of-contents__link toc-highlight">给出代码</a></li><li><a href="#提出问题-1" class="table-of-contents__link toc-highlight">提出问题</a></li></ul></li><li><a href="#使用依赖隔离模式来改进" class="table-of-contents__link toc-highlight">使用依赖隔离模式来改进</a><ul><li><a href="#概述解决方案-1" class="table-of-contents__link toc-highlight">概述解决方案</a></li><li><a href="#给出uml-2" class="table-of-contents__link toc-highlight">给出UML</a></li><li><a href="#结合uml图描述如何具体地解决问题-1" class="table-of-contents__link toc-highlight">结合UML图，描述如何具体地解决问题</a></li><li><a href="#给出代码-2" class="table-of-contents__link toc-highlight">给出代码</a></li></ul></li><li><a href="#定义" class="table-of-contents__link toc-highlight">定义</a><ul><li><a href="#一句话定义" class="table-of-contents__link toc-highlight">一句话定义</a></li><li><a href="#补充说明" class="table-of-contents__link toc-highlight">补充说明</a></li><li><a href="#通用uml" class="table-of-contents__link toc-highlight">通用UML</a></li><li><a href="#角色的抽象代码" class="table-of-contents__link toc-highlight">角色的抽象代码</a></li><li><a href="#遵循的设计原则在uml中的体现" class="table-of-contents__link toc-highlight">遵循的设计原则在UML中的体现</a></li></ul></li><li><a href="#应用" class="table-of-contents__link toc-highlight">应用</a><ul><li><a href="#优点" class="table-of-contents__link toc-highlight">优点</a></li><li><a href="#缺点" class="table-of-contents__link toc-highlight">缺点</a></li><li><a href="#使用场景" class="table-of-contents__link toc-highlight">使用场景</a></li><li><a href="#注意事项" class="table-of-contents__link toc-highlight">注意事项</a></li></ul></li><li><a href="#扩展" class="table-of-contents__link toc-highlight">扩展</a><ul><li><a href="#升级为洋葱架构" class="table-of-contents__link toc-highlight">升级为洋葱架构</a></li></ul></li><li><a href="#最佳实践" class="table-of-contents__link toc-highlight">最佳实践</a><ul><li><a href="#哪些场景不需要使用模式" class="table-of-contents__link toc-highlight">哪些场景不需要使用模式</a></li><li><a href="#给出具体的实践案例" class="table-of-contents__link toc-highlight">给出具体的实践案例</a></li></ul></li><li><a href="#更多资料推荐" class="table-of-contents__link toc-highlight">更多资料推荐</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items"><li class="footer__item"><a href="https://qm.qq.com/cgi-bin/qm/qr?k=SaSgwsyiccUjc3Mx3Jqliv9HJnHxL-WI&amp;jump_from=webapi&amp;authKey=+EQRAdLQ80spfX++pA3UB4erf6cxC+Mo4jH6bfovhdE7MOvI5WBUljCZ6roGaNZh" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>与作者交流加QQ群<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items"><li class="footer__item"><a href="https://www.zhihu.com/people/dreamforest-yyc" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>作者的知乎<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.cnblogs.com/chaogex/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>作者的博客<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/3dProgramPattern/assets/js/runtime~main.64bc8973.js"></script>
<script src="/3dProgramPattern/assets/js/main.c6dc4a90.js"></script>
</body>
</html>